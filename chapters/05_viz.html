
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>5. Next-level Data Visualization &#8212; Intermediate Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/05_viz';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="References" href="references.html" />
    <link rel="prev" title="4. Making Python Projects &amp; Environments Reproducible" href="02_reproducible.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/datalab-logo-full-color-rgb-1.png" class="logo__image only-light" alt="Intermediate Python - Home"/>
    <script>document.write(`<img src="../_static/datalab-logo-full-color-rgb-1.png" class="logo__image only-dark" alt="Intermediate Python - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    Overview
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Thinking in Python</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_pandas.html">1. Slicing &amp; Dicing Data with pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_iterators.html">2. Iterator &amp; Generator Crash Course</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_debugging.html">3. Squashing Bugs with Python’s Debugging Tools</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Writing Python Scripts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="02_reproducible.html">4. Making Python Projects &amp; Environments Reproducible</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Other Workshops</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">5. Next-level Data Visualization</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Afterword</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgements</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ucdavisdatalab/workshop_intermediate_python" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ucdavisdatalab/workshop_intermediate_python/issues/new?title=Issue%20on%20page%20%2Fchapters/05_viz.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapters/05_viz.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Next-level Data Visualization</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites">5.1. Prerequisites</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thinking-in-matplotlib">5.2. Thinking in Matplotlib</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">5.2.1. Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#figures-axes">5.2.2. Figures &amp; Axes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coding-styles">5.2.3. Coding Styles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#drawing-on-axes">5.2.4. Drawing on Axes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#formatting-figures-axes">5.2.5. Formatting Figures &amp; Axes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-figures">5.2.6. Saving Figures</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualization-best-practices">5.3. Visualization Best Practices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#case-studies">5.4. Case Studies</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-a-categorical-distribution">5.4.1. Plotting a Categorical Distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-a-continuous-distribution">5.4.2. Plotting a Continuous Distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-a-time-series">5.4.3. Plotting a Time Series</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-a-function">5.4.4. Plotting a Function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-an-image">5.4.5. Plotting an Image</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-a-map">5.4.6. Plotting a Map</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="next-level-data-visualization">
<span id="chapter-viz"></span><h1><span class="section-number">5. </span>Next-level Data Visualization<a class="headerlink" href="#next-level-data-visualization" title="Link to this heading">#</a></h1>
<div class="admonition-learning-objectives admonition">
<p class="admonition-title">Learning Objectives</p>
<ul class="simple">
<li><p>Describe Matplotlib</p></li>
<li><p>Describe and identify the components of a Matplotlib Figure</p></li>
<li><p>Describe a Matplotlib Axes</p></li>
<li><p>Explain the difference between Matplotlib’s explicit and implicit interfaces</p></li>
<li><p>Create Matplotlib Figures and Axes</p></li>
<li><p>Modify Matplotlib plots with Figure and Axes methods</p></li>
<li><p>Describe Matplotlib’s coding styles</p></li>
<li><p>Choose appropriate visualizations based on data type(s)</p></li>
<li><p>List the steps to making a well-designed visualization</p></li>
<li><p>Assess what aspects of a visualization need improvement</p></li>
<li><p>Use Matplotlib to customize visualizations made with other packages</p></li>
<li><p>Create well-designed data visualizations</p></li>
</ul>
</div>
<p>This chapter is about customizing data visualizations in Python. <a class="reference external" href="https://seaborn.pydata.org/">Seaborn</a>,
<a class="reference external" href="https://plotnine.readthedocs.io/en/stable/">plotnine</a>, <a class="reference external" href="https://pandas.pydata.org/">pandas</a>, and many other packages rely on the <a class="reference external" href="https://matplotlib.org/">Matplotlib</a>
package to create visualizations. Thus the first section delves into
Matplotlib’s interfaces and computational model: how to reason about and modify
visualizations created with the package. The second section puts the ideas from
the first into practice by presenting a selection of case studies with real
data, where creating a great visualization depends on customizing the default
outputs from Seaborn with some Matplotlib code.</p>
<section id="prerequisites">
<h2><span class="section-number">5.1. </span>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading">#</a></h2>
<p>This chapter assumes you are already familiar with Python, pandas, and at least
one way of making data visualizations. In particular, you should be comfortable
working with <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s and creating scatter, line, and bar plots from data.
DataLab’s <a class="reference external" href="https://ucdavisdatalab.github.io/workshop_python_basics/">Python Basics Reader</a> and its accompanying workshop
provide a suitable introduction to these topics.</p>
<p>To follow along, you’ll need the following software versions (or newer)
installed on your computer:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.python.org/">Python</a> 3.10</p></li>
<li><p><a class="reference external" href="https://matplotlib.org/">Matplotlib</a> 3.7</p></li>
<li><p><a class="reference external" href="https://numpy.org/">NumPy</a> 1.24</p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/">Pandas</a> 1.5</p></li>
<li><p><a class="reference external" href="https://pillow.readthedocs.io/en/stable/">Pillow</a> 9.5</p></li>
<li><p><a class="reference external" href="https://arrow.apache.org/docs/python/">PyArrow</a> 11.0</p></li>
<li><p><a class="reference external" href="https://seaborn.pydata.org/">Seaborn</a> 0.12</p></li>
</ul>
<p>One way to install all of these at once is to install the <a class="reference external" href="https://www.anaconda.com/">Anaconda</a> Python
distribution. <a class="reference internal" href="02_reproducible.html#chapter-reproducible"><span class="std std-numref">Chapter 4</span></a> provides
additional details about Anaconda and the <code class="docutils literal notranslate"><span class="pre">conda</span></code> package manager.</p>
</section>
<section id="thinking-in-matplotlib">
<h2><span class="section-number">5.2. </span>Thinking in Matplotlib<a class="headerlink" href="#thinking-in-matplotlib" title="Link to this heading">#</a></h2>
<p>Matplotlib is a relatively low-level visualization package, which means you can
use it to draw almost anything, but that creating and fine-tuning common
statistical plots usually requires more code than with other packages. The
package has <a class="reference external" href="https://matplotlib.org/stable/">extensive documentation</a>, including <a class="reference external" href="https://matplotlib.org/stable/tutorials/">tutorials</a> and
<a class="reference external" href="https://matplotlib.org/cheatsheets/">cheat sheets</a>. While the size of Matplotlib’s programming interface can be
daunting, there’s an ongoing effort to make it more user-friendly and make the
documentation more approachable, and there have already been big improvements
in the last three years.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This section is loosely based on Matplotlib’s <a class="reference external" href="https://matplotlib.org/stable/tutorials/introductory/quick_start.html">Quick Start Guide</a>.</p>
</div>
<section id="introduction">
<span id="mpl-introduction"></span><h3><span class="section-number">5.2.1. </span>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h3>
<figure class="align-default" id="penguins">
<img alt="../_images/lter_penguins.png" src="../_images/lter_penguins.png" />
<figcaption>
<p><span class="caption-number">Fig. 5.1 </span><span class="caption-text"><a class="reference external" href="https://allisonhorst.com/">Artwork by &#64;allison_horst</a>.</span><a class="headerlink" href="#penguins" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>As a way to learn the fundamentals of Matplotlib, you’ll recreate the scatter
plot (without the regression lines) in <a class="reference internal" href="#flipper-bill"><span class="std std-numref">Fig. 5.2</span></a>, which shows
flipper length versus bill length for hundreds of individual penguins from
three different species: <a class="reference external" href="https://en.wikipedia.org/wiki/Ad%C3%A9lie_penguin">Adélie</a>, <a class="reference external" href="https://en.wikipedia.org/wiki/Chinstrap_penguin">Chinstrap</a>, and <a class="reference external" href="https://en.wikipedia.org/wiki/Gentoo_penguin">Gentoo</a>. Both the
plot and data come from the <a class="reference external" href="https://allisonhorst.github.io/palmerpenguins/">Palmer Penguins data set</a>, which was
collected by <a class="reference external" href="https://www.uaf.edu/cfos/people/faculty/detail/kristen-gorman.php">Dr. Kristen Gorman</a> at <a class="reference external" href="https://pallter.marine.rutgers.edu/">Palmer Station,
Antarctica</a>, and packaged for public use by <a class="reference external" href="https://allisonhorst.com/">Alison Horst</a>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>You can download a version of the Palmer Penguins data set that we’ve prepared
for Python <a class="reference external" href="https://ucdavis.box.com/s/pjcr4l989v6k4ikxou7r4ws54t2qrbjs">HERE</a>.</p>
</div>
<figure class="align-default" id="flipper-bill">
<img alt="../_images/flipper-bill.png" src="../_images/flipper-bill.png" />
<figcaption>
<p><span class="caption-number">Fig. 5.2 </span><span class="caption-text">A scatter plot from the <a class="reference external" href="https://allisonhorst.github.io/palmerpenguins/">Palmer Penguins data set</a>.</span><a class="headerlink" href="#flipper-bill" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>After downloading the data set, use pandas to read it and display some summary
information:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">penguins</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;data/penguins.parquet&quot;</span><span class="p">)</span>
<span class="n">penguins</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.1</td>
      <td>18.7</td>
      <td>181.0</td>
      <td>3750.0</td>
      <td>male</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.5</td>
      <td>17.4</td>
      <td>186.0</td>
      <td>3800.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>40.3</td>
      <td>18.0</td>
      <td>195.0</td>
      <td>3250.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>36.7</td>
      <td>19.3</td>
      <td>193.0</td>
      <td>3450.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">penguins</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 344 entries, 0 to 343
Data columns (total 8 columns):
 #   Column             Non-Null Count  Dtype   
---  ------             --------------  -----   
 0   species            344 non-null    category
 1   island             344 non-null    category
 2   bill_length_mm     342 non-null    float64 
 3   bill_depth_mm      342 non-null    float64 
 4   flipper_length_mm  342 non-null    float64 
 5   body_mass_g        342 non-null    float64 
 6   sex                333 non-null    category
 7   year               344 non-null    int32   
dtypes: category(3), float64(4), int32(1)
memory usage: 13.6 KB
</pre></div>
</div>
</div>
</div>
<p>Matplotlib’s primary interface for creating plots interactively is <strong>PyPlot</strong>
(<code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code>). The convention is to import PyPlot as <code class="docutils literal notranslate"><span class="pre">plt</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<p>PyPlot’s <code class="docutils literal notranslate"><span class="pre">plt.scatter</span></code> function creates a scatter plot. The first and second
argument set the x and y axis, respectively. For the plot in
<a class="reference internal" href="#flipper-bill"><span class="std std-numref">Fig. 5.2</span></a>, penguin flipper length should be on the x-axis and bill
length should be on the y-axis. Use the <code class="docutils literal notranslate"><span class="pre">plt.scatter</span></code> function to create the
plot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">penguins</span><span class="p">[</span><span class="s2">&quot;flipper_length_mm&quot;</span><span class="p">],</span> <span class="n">penguins</span><span class="p">[</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x71de97afef90&gt;
</pre></div>
</div>
<img alt="../_images/565749de0550eac273e9d17cf62adf88e0edab67d3bcb17db6abf4cf9b18b13b.png" src="../_images/565749de0550eac273e9d17cf62adf88e0edab67d3bcb17db6abf4cf9b18b13b.png" />
</div>
</div>
<p>This austere scatter plot is typical of Matplotlib functions: if you want fancy
formatting, you have to set more parameters and make more function calls.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you’re using Jupyter, notice that in addition to the plot, there’s also some
output about a <code class="docutils literal notranslate"><span class="pre">matplotlib.collections.PathCollection</span></code>. This happens because
most Matplotlib functions and methods return a result—typically the object
you added to the plot—and Jupyter prints the last result in each code cell.</p>
<p>The output is harmless and safe to ignore, but if it bothers you, you can add a
call to <code class="docutils literal notranslate"><span class="pre">plt.show</span></code> at the end of each cell where you make a plot.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Most Matplotlib plotting functions provide an alternative interface through the
<code class="docutils literal notranslate"><span class="pre">data</span></code> parameter for string-indexed data such as data frames and dicts. For
instance, if you set <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">=</span> <span class="pre">penguins</span></code> in the <code class="docutils literal notranslate"><span class="pre">plt.scatter</span></code> function, then you
can use column names to set the x and y axis:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="s2">&quot;flipper_length_mm&quot;</span><span class="p">,</span> <span class="s2">&quot;bill_length_mm&quot;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">penguins</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>How much formatting a plot requires depends on the intended audience, but even
if you’re only making the plot for yourself, you might want to put some axis
labels on it to remind you of what it’s showing. You might also want to make
the points partially transparent so that you can see whether any points are
hidden under others and use point styles to incorporate additional information
from the data set. If you’re making a plot to share with others, you might also
want to add a title and go through DataLab’s <a class="reference external" href="https://github.com/ucdavisdatalab/workshop_handouts/blob/main/src/graphics_checklist.md">Data Visualization
Guidelines</a>.</p>
<p>Eventually you’ll customize the penguin scatter plot, but first you need to
know a little bit more about how Matplotlib works.</p>
</section>
<section id="figures-axes">
<span id="mpl-figures-axes"></span><h3><span class="section-number">5.2.2. </span>Figures &amp; Axes<a class="headerlink" href="#figures-axes" title="Link to this heading">#</a></h3>
<p>Matplotlib uses specific terms for the components of a visualization which can
be confusing if you aren’t aware of them. The most important terms are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Artist</span></code>: any Matplotlib object, including the other items on this list.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Figure</span></code>: an entire visualization. A Figure can contain one or <em>more</em> plots.
You’ll typically interact with Figures when you want to set margins on,
display, or save a visualization.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Axes</span></code>: a single plot. An Axes can contain many other Artists. You’ll
typically interact with Axes when you want to add additional data or
customize the components (styles, colors, and so on) of a plot.</p></li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Despite the name, an <code class="docutils literal notranslate"><span class="pre">Axes</span></code> object represents an entire plot (within a larger
visualization), not the axes on a plot. The represented plot might not even
have visible axes.</p>
<p>Each <em>axis</em> on a plot is represented by a separate <code class="docutils literal notranslate"><span class="pre">Axis</span></code> object (with an “i”).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this reader, we use monospace (<code class="docutils literal notranslate"><span class="pre">Axes</span></code>) or title-case (Axes) to refer to
Python classes and lowercase (axes) for plain English.</p>
</div>
<p>Thus in Matplotlib terms, a visualization consists of a Figure with at least
one Axes. Both are Artists, and an Axes usually contains additional Artists for
lines, points, axes, legends, and so on. <a class="reference internal" href="#mpl-anatomy"><span class="std std-numref">Fig. 5.3</span></a> identifies
Matplotlib terms on an actual visualization. Keep it or the <a class="reference external" href="https://matplotlib.org/cheatsheets/">cheat sheet</a> at hand as you’re learning the package.</p>
<figure class="align-default" id="mpl-anatomy">
<img alt="../_images/anatomy.png" src="../_images/anatomy.png" />
<figcaption>
<p><span class="caption-number">Fig. 5.3 </span><span class="caption-text">The anatomy of a Matplotlib figure.</span><a class="headerlink" href="#mpl-anatomy" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The <code class="docutils literal notranslate"><span class="pre">plt.subplots</span></code> function creates a Figure with one or more Axes arranged in
a grid, so it’s the starting point for most visualizations. The function
returns a tuple with the Figure and the Axes. By default, it only creates one
Axes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1d9291a9ac5bde7c4ddefc7b11da247268e3056dcf3eb1f857e3a5dad85748ba.png" src="../_images/1d9291a9ac5bde7c4ddefc7b11da247268e3056dcf3eb1f857e3a5dad85748ba.png" />
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Matplotlib also has a <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html"><code class="docutils literal notranslate"><span class="pre">plt.subplot</span></code> function</a> (without the final
“s”). It adds an Axes to an existing Figure rather than creating a new Figure
and Axes. To create a new visualization, the <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html"><code class="docutils literal notranslate"><span class="pre">plt.subplots</span></code>
function</a> (with the final “s”) is the one you want.</p>
</div>
<p>Once you’ve created a Figure and Axes, you can call methods on the Axes to add
details. <a class="reference internal" href="#mpl-introduction"><span class="std std-numref">Section 5.2.1</span></a> explained how to create a scatter plot of
the Palmer Penguins data set with the <code class="docutils literal notranslate"><span class="pre">plt.scatter</span></code> function. Another approach
is to use the <code class="docutils literal notranslate"><span class="pre">.scatter</span></code> method on an Axes instead:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">penguins</span><span class="p">[</span><span class="s2">&quot;flipper_length_mm&quot;</span><span class="p">],</span> <span class="n">penguins</span><span class="p">[</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x71de978647d0&gt;
</pre></div>
</div>
<img alt="../_images/565749de0550eac273e9d17cf62adf88e0edab67d3bcb17db6abf4cf9b18b13b.png" src="../_images/565749de0550eac273e9d17cf62adf88e0edab67d3bcb17db6abf4cf9b18b13b.png" />
</div>
</div>
<p><a class="reference internal" href="#mpl-coding-styles"><span class="std std-numref">Section 5.2.3</span></a> provides more information about these two different
approaches to creating plots.</p>
<p>The first two arguments to <code class="docutils literal notranslate"><span class="pre">plt.subplots</span></code> control the number of rows and number
of columns, respectively, in the grid of Axes. When the grid contains more than
one Axes, the Axes are returned in a 2-dimensional Numpy array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1985155414d91ca6b371ad2a52f9cac535e958e67d9eeed402507caa5d97966f.png" src="../_images/1985155414d91ca6b371ad2a52f9cac535e958e67d9eeed402507caa5d97966f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">axs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[&lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;],
       [&lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;]], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>You can index this array with square brackets <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span></code> in order to get the
individual Axes. For example, <code class="docutils literal notranslate"><span class="pre">axs[0,</span> <span class="pre">2]</span></code> gets the Axes in the first row and
third column.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want make a visualization where some subplots span multiple grid cells,
take a look at the <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot_mosaic.html"><code class="docutils literal notranslate"><span class="pre">plt.subplot_mosaic</span></code> function</a>. You can
use it to concisely describe and create Figures with complex arrangements of
Axes.</p>
</div>
<p>Notice that in the displayed Figure, there’s not much space between the
components and some of them even overlap. You can tell Matplotlib to <a class="reference external" href="https://matplotlib.org/stable/tutorials/intermediate/constrainedlayout_guide.html">use a
constraint solver</a> to determine appropriate sizes for each
subplot by setting <code class="docutils literal notranslate"><span class="pre">layout</span> <span class="pre">=</span> <span class="pre">&quot;constrained&quot;</span></code> on the Figure. The <code class="docutils literal notranslate"><span class="pre">plt.subplots</span></code>
function accepts Figure-level keyword arguments, so one way to do this is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">layout</span> <span class="o">=</span> <span class="s2">&quot;constrained&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/32c472bb8481f9974392f9bce5e0fc7c390476e44657c919da79dd2728fcc1fd.png" src="../_images/32c472bb8481f9974392f9bce5e0fc7c390476e44657c919da79dd2728fcc1fd.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Constrained layout is not the only layout possible, and you may encounter
visualizations that use <a class="reference external" href="https://matplotlib.org/stable/tutorials/intermediate/tight_layout_guide.html">tight layout</a> instead. <a class="reference external" href="https://github.com/matplotlib/cheatsheets/issues/30">According to the
Matplotlib developers</a>, constrained layout produces
better results in most cases.</p>
</div>
<p>You can control the size of an entire Figure with another setting, <code class="docutils literal notranslate"><span class="pre">figsize</span></code>.
The argument should be a tuple with a width and height of the Figure in inches.
This can also be set through <code class="docutils literal notranslate"><span class="pre">plt.subplots</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ab96dbc1c0e3b6c6724e641c456c694bdd9722f864cfbbde4d8175e4ef3df9c7.png" src="../_images/ab96dbc1c0e3b6c6724e641c456c694bdd9722f864cfbbde4d8175e4ef3df9c7.png" />
</div>
</div>
<p>The Matplotlib documentation has a <a class="reference external" href="https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure">reference page with a list of other
Figure-level keyword arguments</a>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can change Figure settings globally through <code class="docutils literal notranslate"><span class="pre">mpl.rcParams</span></code>, which is a
dict-like object. See the <a class="reference external" href="https://matplotlib.org/stable/api/matplotlib_configuration_api.html#matplotlib.rcParams">documentation page</a> and the
<a class="reference external" href="https://matplotlib.org/stable/tutorials/introductory/customizing.html">guide</a> for more details.</p>
</div>
</section>
<section id="coding-styles">
<span id="mpl-coding-styles"></span><h3><span class="section-number">5.2.3. </span>Coding Styles<a class="headerlink" href="#coding-styles" title="Link to this heading">#</a></h3>
<p><a class="reference internal" href="#mpl-introduction"><span class="std std-numref">Section 5.2.1</span></a> and <a class="reference internal" href="#mpl-figures-axes"><span class="std std-numref">Section 5.2.2</span></a> explained two
different ways to create a scatter plot. Matplotlib actually supports <em>three</em>
different coding styles, two of which use the PyPlot interface:</p>
<ol class="arabic simple">
<li><p><strong>PyPlot style</strong>, where you use the PyPlot interface for everything, from
plot creation to customization. This style is convenient for interactive
work in the Python console because you don’t have to keep track of any
intermediate variables—you just use <code class="docutils literal notranslate"><span class="pre">plt</span></code>.</p></li>
<li><p><strong>Object-oriented (OO) style</strong>, where you only use the PyPlot interface to
create the <code class="docutils literal notranslate"><span class="pre">Figure</span></code> and <code class="docutils literal notranslate"><span class="pre">Axes</span></code>, and then use method calls to add detail and
customize.</p></li>
<li><p><strong>Embedded style</strong>: where you don’t use the PyPlot interface at all.
Instead, you create a <code class="docutils literal notranslate"><span class="pre">Figure</span></code> by explicitly calling the <code class="docutils literal notranslate"><span class="pre">Figure</span></code>
constructor function and attaching a canvas, and then use method calls to
add <code class="docutils literal notranslate"><span class="pre">Axes</span></code> and details. This style is convenient for non-interactive work,
because it allows greater control over where Figures are drawn.</p></li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When you use either the PyPlot or OO style, it’s up to you to explicitly close
Figures by calling <code class="docutils literal notranslate"><span class="pre">plt.close</span></code> when you’re done with them. If you create many
Figures without closing them, Python may run out of memory. Matplotlib will
automatically issue a warning if you have more than 20 Figures open.</p>
<p>When you use the embedded style, Python will automatically close Figures when
they go out of scope. If you need to close a Figure before it goes out of
scope, you can use the <code class="docutils literal notranslate"><span class="pre">del</span></code> keyword.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Many PyPlot functions and Axes methods have the same names and signatures, but
not all of them. So translating between the PyPlot style and OO style sometimes
requires searching the documentation even if you have one style memorized.</p>
</div>
<p>The Matplotlib documentation suggests using the OO style in most scenarios. For
scripts that are intended to run non-interactively and save many plots to disk,
the embedded style is usually more memory efficient. Switching between the OO
and embedded style is relatively easy, since the only major difference is in
how Figures and Axes are created. Thus we recommend the OO style and use it in
all of the remaining examples.</p>
</section>
<section id="drawing-on-axes">
<span id="mpl-drawing-on-axes"></span><h3><span class="section-number">5.2.4. </span>Drawing on Axes<a class="headerlink" href="#drawing-on-axes" title="Link to this heading">#</a></h3>
<p>Matplotlib provides Axes methods for drawing points, lines, text, legends,
shapes, and more. In this section, you’ll use some of these methods to add
detail to the scatter plot of the Palmer Penguins data set, so that it looks
more like <a class="reference internal" href="#flipper-bill"><span class="std std-numref">Fig. 5.2</span></a>. <a class="reference internal" href="#mpl-figures-axes"><span class="std std-numref">Section 5.2.2</span></a> left off with this
version of the plot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">layout</span> <span class="o">=</span> <span class="s2">&quot;constrained&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">penguins</span><span class="p">[</span><span class="s2">&quot;flipper_length_mm&quot;</span><span class="p">],</span> <span class="n">penguins</span><span class="p">[</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x71de8f4647d0&gt;
</pre></div>
</div>
<img alt="../_images/0e500f8f5d7a8e4e75860d2162ed6a44fc998a2f34f389a6e85093bed9f854fb.png" src="../_images/0e500f8f5d7a8e4e75860d2162ed6a44fc998a2f34f389a6e85093bed9f854fb.png" />
</div>
</div>
<p>In <a class="reference internal" href="#flipper-bill"><span class="std std-numref">Fig. 5.2</span></a>, the shape and color of each point indicates the
species of penguin. Orange circles represent Adelie penguins, purple triangles
represent Chinstrap penguins, and teal squares represent Gentoo penguins.</p>
<p>You can set the shape of the points plotted by the <code class="docutils literal notranslate"><span class="pre">.scatter</span></code> method with the
<code class="docutils literal notranslate"><span class="pre">marker</span></code> parameter. Matplotlib uses shorthand strings to represent different
marker types. For instance, <code class="docutils literal notranslate"><span class="pre">&quot;o&quot;</span></code> means a circle, and <code class="docutils literal notranslate"><span class="pre">&quot;^&quot;</span></code> means a point-up
triangle, and <code class="docutils literal notranslate"><span class="pre">&quot;s&quot;</span></code> means a square. The documentation includes a <a class="reference external" href="https://matplotlib.org/stable/api/markers_api.html#module-matplotlib.markers">complete list
of markers</a>.</p>
<p>When you call the <code class="docutils literal notranslate"><span class="pre">.scatter</span></code> method, you can only set one shape for the points.
To plot a different shape for each group, make a separate call to <code class="docutils literal notranslate"><span class="pre">.scatter</span></code>
for each group. For example, to plot only the points for the Chinstrap
penguins:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">layout</span> <span class="o">=</span> <span class="s2">&quot;constrained&quot;</span><span class="p">)</span>

<span class="n">obs</span> <span class="o">=</span> <span class="n">penguins</span><span class="p">[</span><span class="n">penguins</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Chinstrap&quot;</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;flipper_length_mm&quot;</span><span class="p">],</span> <span class="n">obs</span><span class="p">[</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;^&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x71de8f4b7110&gt;
</pre></div>
</div>
<img alt="../_images/c774e604a7588f2feda484c8cb668850f4e8c0880ab6e423413e0c7e29d81eaf.png" src="../_images/c774e604a7588f2feda484c8cb668850f4e8c0880ab6e423413e0c7e29d81eaf.png" />
</div>
</div>
<p>You can use a dictionary and a loop to concisely plot multiple groups:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">layout</span> <span class="o">=</span> <span class="s2">&quot;constrained&quot;</span><span class="p">)</span>

<span class="n">groups</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Adelie&quot;</span><span class="p">:</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="s2">&quot;Chinstrap&quot;</span><span class="p">:</span> <span class="s2">&quot;^&quot;</span><span class="p">,</span> <span class="s2">&quot;Gentoo&quot;</span><span class="p">:</span> <span class="s2">&quot;s&quot;</span><span class="p">}</span>
<span class="k">for</span> <span class="n">species</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="n">groups</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">penguins</span><span class="p">[</span><span class="n">penguins</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">species</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">obs</span><span class="p">[</span><span class="s2">&quot;flipper_length_mm&quot;</span><span class="p">],</span> <span class="n">obs</span><span class="p">[</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="n">marker</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/60fd1add27d0b862763d607f8d2699d1169e7e5bbaaa2953e1f546e39e032a5e.png" src="../_images/60fd1add27d0b862763d607f8d2699d1169e7e5bbaaa2953e1f546e39e032a5e.png" />
</div>
</div>
<p>When you call the <code class="docutils literal notranslate"><span class="pre">.scatter</span></code> method many times like this, Matplotlib
automatically cycles through the colors in its default palette. The package
also does this for most other kinds of plots.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In computing contexts, colors are often described in terms of their percentages
of red, green, and blue (RGB) light or <strong>channels</strong>. You can write this as a
tuple of decimal numbers, each between 0.0 and 1.0. For example, <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></code> is
black, <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1)</span></code> is white, <code class="docutils literal notranslate"><span class="pre">(0.5,</span> <span class="pre">0,</span> <span class="pre">0.5)</span></code> is purple, and <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">0.5,</span> <span class="pre">0.5)</span></code> is
teal.</p>
<p>For memory efficiency, each color channel is usually limited to 256 different
values (8 bits per channel, or 24-bit color). In this case, you can write a
color as a tuple of integers. For instance, <code class="docutils literal notranslate"><span class="pre">(128,</span> <span class="pre">0,</span> <span class="pre">128)</span></code> is purple.</p>
<p>You can write integer color codes concisely by using the base-16 number system,
called <a class="reference external" href="https://en.wikipedia.org/wiki/Hexadecimal"><strong>hexadecimal</strong></a>. In hexadecimal, each digit represents one of 16
values (0 to 15). Conventionally, the digits are written 0-9 and a-f (10-15).
Thus 8 is written as <code class="docutils literal notranslate"><span class="pre">8</span></code>, 90 is written as <code class="docutils literal notranslate"><span class="pre">5a</span></code>, and 255 is written as <code class="docutils literal notranslate"><span class="pre">ff</span></code>.
Since each color channel ranges from 0 to 255, you can write each channel with
two hex digits, and thus a whole color with six hex digits. Hex codes for
colors are usually prefixed with <code class="docutils literal notranslate"><span class="pre">#</span></code>, so for example <code class="docutils literal notranslate"><span class="pre">#800080</span></code> is purple.</p>
<p>A red-green-blue-alpha (RGBA) color has a fourth channel called <strong>alpha</strong> that
controls the opacity. RGBA colors are usually 32-bit colors and thus can be
written with eight hex digits.</p>
<p>In Matplotlib, you can specify RGB and RGBA colors as hex codes. The
documentation also describes <a class="reference external" href="https://matplotlib.org/stable/tutorials/colors/colors.html">several other ways to specify
colors</a>.</p>
</div>
<p>To explicitly set the color of the points in a call to <code class="docutils literal notranslate"><span class="pre">.scatter</span></code>, use the
<code class="docutils literal notranslate"><span class="pre">color</span></code> parameter. In <a class="reference internal" href="#flipper-bill"><span class="std std-numref">Fig. 5.2</span></a>, Adelie orange is approximately
<code class="docutils literal notranslate"><span class="pre">#fe8700</span></code>, Chinstrap purple is approximately <code class="docutils literal notranslate"><span class="pre">#9a27ef</span></code>, and Gentoo teal is
approximately <code class="docutils literal notranslate"><span class="pre">#098b8b</span></code>. The points are slightly transparent, so it’s also a
good idea to append <code class="docutils literal notranslate"><span class="pre">c0</span></code> to each color code to set 75% opacity. You can add the
color codes to the groups dictionary:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">layout</span> <span class="o">=</span> <span class="s2">&quot;constrained&quot;</span><span class="p">)</span>

<span class="n">groups</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Adelie&quot;</span>    <span class="p">:</span> <span class="p">(</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="s2">&quot;#fe8700c0&quot;</span><span class="p">),</span>
    <span class="s2">&quot;Chinstrap&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="s2">&quot;^&quot;</span><span class="p">,</span> <span class="s2">&quot;#9a27efc0&quot;</span><span class="p">),</span>
    <span class="s2">&quot;Gentoo&quot;</span>    <span class="p">:</span> <span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="s2">&quot;#098b8bc0&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">species</span><span class="p">,</span> <span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span> <span class="ow">in</span> <span class="n">groups</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">penguins</span><span class="p">[</span><span class="n">penguins</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">species</span><span class="p">]</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">obs</span><span class="p">[</span><span class="s2">&quot;flipper_length_mm&quot;</span><span class="p">],</span> <span class="n">obs</span><span class="p">[</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="n">marker</span><span class="p">,</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4f20112efdd986280015abd656f9d647aa9c17b01a06ac8a1d6808a9bb70e3bb.png" src="../_images/4f20112efdd986280015abd656f9d647aa9c17b01a06ac8a1d6808a9bb70e3bb.png" />
</div>
</div>
<p>The figure also has a legend. You can add a legend to a Matplotlib Axes by
calling the <code class="docutils literal notranslate"><span class="pre">.legend</span></code> method. Matplotlib will guess what to show in the legend
based on the labeled components of the plot. You can set the <code class="docutils literal notranslate"><span class="pre">label</span></code> parameter
in the <code class="docutils literal notranslate"><span class="pre">.scatter</span></code> method to label a group of points. The label will be
displayed in the legend. You can also use parameters of the <code class="docutils literal notranslate"><span class="pre">.legend</span></code> method to
control the legend directly. For instance, <code class="docutils literal notranslate"><span class="pre">title</span></code> sets the title and <code class="docutils literal notranslate"><span class="pre">frameon</span></code>
controls whether the legend is displayed in a box. After adding a legend, the
code becomes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">layout</span> <span class="o">=</span> <span class="s2">&quot;constrained&quot;</span><span class="p">)</span>

<span class="n">groups</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Adelie&quot;</span>    <span class="p">:</span> <span class="p">(</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="s2">&quot;#fe8700c0&quot;</span><span class="p">),</span>
    <span class="s2">&quot;Chinstrap&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="s2">&quot;^&quot;</span><span class="p">,</span> <span class="s2">&quot;#9a27efc0&quot;</span><span class="p">),</span>
    <span class="s2">&quot;Gentoo&quot;</span>    <span class="p">:</span> <span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="s2">&quot;#098b8bc0&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">species</span><span class="p">,</span> <span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span> <span class="ow">in</span> <span class="n">groups</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">penguins</span><span class="p">[</span><span class="n">penguins</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">species</span><span class="p">]</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">obs</span><span class="p">[</span><span class="s2">&quot;flipper_length_mm&quot;</span><span class="p">],</span> <span class="n">obs</span><span class="p">[</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="n">marker</span><span class="p">,</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">species</span><span class="p">)</span> 

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Penguin species&quot;</span><span class="p">,</span> <span class="n">frameon</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x71de97aff770&gt;
</pre></div>
</div>
<img alt="../_images/0f80a4aba3a8e0efd4eac501ee2d64881ce9d2e3be181e44ba0b3d4fc02a0850.png" src="../_images/0f80a4aba3a8e0efd4eac501ee2d64881ce9d2e3be181e44ba0b3d4fc02a0850.png" />
</div>
</div>
<p><a class="reference internal" href="#flipper-bill"><span class="std std-numref">Fig. 5.2</span></a> also has grid lines. The Axes method <code class="docutils literal notranslate"><span class="pre">.grid</span></code> controls
the display of grid lines. The first argument is a Boolean value that sets
whether the grid lines are visible. An Axes can have major or minor grid lines,
which correspond to the major (labeled) and minor (unlabeled) ticks on each
axis. The <code class="docutils literal notranslate"><span class="pre">which</span></code> parameter controls which grid lines are affected by the
<code class="docutils literal notranslate"><span class="pre">.grid</span></code> method. It’s necessary to also call the <code class="docutils literal notranslate"><span class="pre">.set_axisbelow</span></code> method if you
want the grid to appear behind other plot components rather than in front of
them. So to add major and minor grid lines:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">layout</span> <span class="o">=</span> <span class="s2">&quot;constrained&quot;</span><span class="p">)</span>

<span class="n">groups</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Adelie&quot;</span>    <span class="p">:</span> <span class="p">(</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="s2">&quot;#fe8700c0&quot;</span><span class="p">),</span>
    <span class="s2">&quot;Chinstrap&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="s2">&quot;^&quot;</span><span class="p">,</span> <span class="s2">&quot;#9a27efc0&quot;</span><span class="p">),</span>
    <span class="s2">&quot;Gentoo&quot;</span>    <span class="p">:</span> <span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="s2">&quot;#098b8bc0&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">species</span><span class="p">,</span> <span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span> <span class="ow">in</span> <span class="n">groups</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">penguins</span><span class="p">[</span><span class="n">penguins</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">species</span><span class="p">]</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">obs</span><span class="p">[</span><span class="s2">&quot;flipper_length_mm&quot;</span><span class="p">],</span> <span class="n">obs</span><span class="p">[</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="n">marker</span><span class="p">,</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">species</span><span class="p">)</span> 

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Penguin species&quot;</span><span class="p">,</span> <span class="n">frameon</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span> <span class="s2">&quot;both&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/98a6841038a0dca3b9c95c9d7f6daae3fa93a21168eff50dc5f31a2e6e759ed2.png" src="../_images/98a6841038a0dca3b9c95c9d7f6daae3fa93a21168eff50dc5f31a2e6e759ed2.png" />
</div>
</div>
<p>The common theme of the <code class="docutils literal notranslate"><span class="pre">.scatter</span></code>, <code class="docutils literal notranslate"><span class="pre">.legend</span></code>, and <code class="docutils literal notranslate"><span class="pre">.grid</span></code> methods is that all
of them draw additional components on an Axes. Some of the components you might
want to draw and the associated methods are:</p>
<ul class="simple">
<li><p>Lines with <code class="docutils literal notranslate"><span class="pre">.plot</span></code> or <code class="docutils literal notranslate"><span class="pre">.add_line</span></code></p></li>
<li><p>Points with <code class="docutils literal notranslate"><span class="pre">.plot</span></code> or <code class="docutils literal notranslate"><span class="pre">.scatter</span></code></p></li>
<li><p>Patches, which includes geometric shapes such as rectangles, with
<code class="docutils literal notranslate"><span class="pre">.add_patch</span></code></p></li>
<li><p>Text with <code class="docutils literal notranslate"><span class="pre">.text</span></code></p></li>
<li><p>Annotations with <code class="docutils literal notranslate"><span class="pre">.annotate</span></code></p></li>
<li><p>Legends with <code class="docutils literal notranslate"><span class="pre">.legend</span></code></p></li>
<li><p>Images with <code class="docutils literal notranslate"><span class="pre">.imshow</span></code></p></li>
</ul>
<p>You can learn more about drawing these components from Matplotlib’s <a class="reference external" href="https://matplotlib.org/stable/tutorials/intermediate/artists.html">Artists
Tutorial</a>.</p>
</section>
<section id="formatting-figures-axes">
<h3><span class="section-number">5.2.5. </span>Formatting Figures &amp; Axes<a class="headerlink" href="#formatting-figures-axes" title="Link to this heading">#</a></h3>
<p><a class="reference internal" href="#mpl-drawing-on-axes"><span class="std std-numref">Section 5.2.4</span></a> explained how to draw the components of a plot,
using the scatter plot of the Palmer Penguins data set as an example. The
result was a version of the plot that has all of the information from
<a class="reference internal" href="#flipper-bill"><span class="std std-numref">Fig. 5.2</span></a>, but not all of the formatting. You can control
formatting such as borders, titles, and labels through Figure and Axes methods.
This section demonstrates how.</p>
<p>Axis labels add important context to a plot, since they describe the meaning
and units for each axis. If you want people to use the axes when they interpret
your plot, make sure to include axis labels. You can add axis labels to the x-
and y-axis of a Matplotlib Axes with the <code class="docutils literal notranslate"><span class="pre">.set_xlabel</span></code> and <code class="docutils literal notranslate"><span class="pre">.set_ylabel</span></code>
method, respectively. For example, for the penguins scatter plot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">layout</span> <span class="o">=</span> <span class="s2">&quot;constrained&quot;</span><span class="p">)</span>

<span class="n">groups</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Adelie&quot;</span>    <span class="p">:</span> <span class="p">(</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="s2">&quot;#fe8700c0&quot;</span><span class="p">),</span>
    <span class="s2">&quot;Chinstrap&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="s2">&quot;^&quot;</span><span class="p">,</span> <span class="s2">&quot;#9a27efc0&quot;</span><span class="p">),</span>
    <span class="s2">&quot;Gentoo&quot;</span>    <span class="p">:</span> <span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="s2">&quot;#098b8bc0&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">species</span><span class="p">,</span> <span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span> <span class="ow">in</span> <span class="n">groups</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">penguins</span><span class="p">[</span><span class="n">penguins</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">species</span><span class="p">]</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">obs</span><span class="p">[</span><span class="s2">&quot;flipper_length_mm&quot;</span><span class="p">],</span> <span class="n">obs</span><span class="p">[</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="n">marker</span><span class="p">,</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">species</span><span class="p">)</span> 

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Penguin species&quot;</span><span class="p">,</span> <span class="n">frameon</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span> <span class="s2">&quot;both&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Flipper length (mm)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Bill length (mm)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Bill length (mm)&#39;)
</pre></div>
</div>
<img alt="../_images/739972e3a68009a3262c7deba1010db257e96a4ae77c0479778d22e2cca4370e.png" src="../_images/739972e3a68009a3262c7deba1010db257e96a4ae77c0479778d22e2cca4370e.png" />
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Matplotlib supports a subset of TeX, so it’s possible to use mathematical
symbols in visualizations. Any TeX expressions you enclose in dollar signs <code class="docutils literal notranslate"><span class="pre">$</span></code>
will be rendered. The <a class="reference external" href="https://matplotlib.org/stable/tutorials/text/mathtext.html">documentation on mathematical expressions</a>
provides more details.</p>
</div>
<p>Similarly, you can add a title to a Matplotlib Axes with the <code class="docutils literal notranslate"><span class="pre">.set_title</span></code>
method. It’s particularly important to put titles on plots that will be
presented without other sources of contextual information, such as captions.
Each Axes can have up to three titles, positioned at the left, center, and
right. The <code class="docutils literal notranslate"><span class="pre">loc</span></code> parameter of <code class="docutils literal notranslate"><span class="pre">.set_title</span></code> controls which title is set. The
title can have multiple lines, as in <a class="reference internal" href="#flipper-bill"><span class="std std-numref">Fig. 5.2</span></a>. With the title,
the penguins plot becomes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">layout</span> <span class="o">=</span> <span class="s2">&quot;constrained&quot;</span><span class="p">)</span>

<span class="n">groups</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Adelie&quot;</span>    <span class="p">:</span> <span class="p">(</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="s2">&quot;#fe8700c0&quot;</span><span class="p">),</span>
    <span class="s2">&quot;Chinstrap&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="s2">&quot;^&quot;</span><span class="p">,</span> <span class="s2">&quot;#9a27efc0&quot;</span><span class="p">),</span>
    <span class="s2">&quot;Gentoo&quot;</span>    <span class="p">:</span> <span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="s2">&quot;#098b8bc0&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">species</span><span class="p">,</span> <span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span> <span class="ow">in</span> <span class="n">groups</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">penguins</span><span class="p">[</span><span class="n">penguins</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">species</span><span class="p">]</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">obs</span><span class="p">[</span><span class="s2">&quot;flipper_length_mm&quot;</span><span class="p">],</span> <span class="n">obs</span><span class="p">[</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="n">marker</span><span class="p">,</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">species</span><span class="p">)</span> 

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Penguin species&quot;</span><span class="p">,</span> <span class="n">frameon</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span> <span class="s2">&quot;both&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Flipper length (mm)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Bill length (mm)&quot;</span><span class="p">)</span>

<span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Flipper and bill length</span>
<span class="s2">Dimensions for Adelie, Chinstrap and Gentoo Penguins at Palmer Station LTER&quot;&quot;&quot;</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.0, 1.0, &#39;Flipper and bill length\nDimensions for Adelie, Chinstrap and Gentoo Penguins at Palmer Station LTER&#39;)
</pre></div>
</div>
<img alt="../_images/1b0b58ed9f740873bba3792e18c5ec1f332fc06cb6ba79f341af67e0a47b194c.png" src="../_images/1b0b58ed9f740873bba3792e18c5ec1f332fc06cb6ba79f341af67e0a47b194c.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Three single <code class="docutils literal notranslate"><span class="pre">'''</span></code> or double quotes <code class="docutils literal notranslate"><span class="pre">&quot;&quot;&quot;</span></code> marks the beginning or end of a
multi-line string.</p>
</div>
<p>With the grid lines visible, the border around the outside of the plot just
makes it look cluttered. According to Matplotlib anatomy chart
(<a class="reference internal" href="#mpl-anatomy"><span class="std std-numref">Fig. 5.3</span></a>), each line in the border is a <code class="docutils literal notranslate"><span class="pre">Spine</span></code>. Every Axes has a
string-indexed <code class="docutils literal notranslate"><span class="pre">.spines</span></code> attribute which contains the Spines, and each Spine
has a <code class="docutils literal notranslate"><span class="pre">.set_visible</span></code> method that controls whether it’s visible. You can call
<code class="docutils literal notranslate"><span class="pre">.set_visible</span></code> on all of the Spines at once by slicing the <code class="docutils literal notranslate"><span class="pre">.spines</span></code> attribute,
as in <code class="docutils literal notranslate"><span class="pre">ax.spines[:]</span></code>. So to hide the spines in the penguins plot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">layout</span> <span class="o">=</span> <span class="s2">&quot;constrained&quot;</span><span class="p">)</span>

<span class="n">groups</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Adelie&quot;</span>    <span class="p">:</span> <span class="p">(</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="s2">&quot;#fe8700c0&quot;</span><span class="p">),</span>
    <span class="s2">&quot;Chinstrap&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="s2">&quot;^&quot;</span><span class="p">,</span> <span class="s2">&quot;#9a27efc0&quot;</span><span class="p">),</span>
    <span class="s2">&quot;Gentoo&quot;</span>    <span class="p">:</span> <span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="s2">&quot;#098b8bc0&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">species</span><span class="p">,</span> <span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span> <span class="ow">in</span> <span class="n">groups</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">penguins</span><span class="p">[</span><span class="n">penguins</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">species</span><span class="p">]</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">obs</span><span class="p">[</span><span class="s2">&quot;flipper_length_mm&quot;</span><span class="p">],</span> <span class="n">obs</span><span class="p">[</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="n">marker</span><span class="p">,</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">species</span><span class="p">)</span> 

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Penguin species&quot;</span><span class="p">,</span> <span class="n">frameon</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span> <span class="s2">&quot;both&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Flipper length (mm)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Bill length (mm)&quot;</span><span class="p">)</span>

<span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Flipper and bill length</span>
<span class="s2">Dimensions for Adelie, Chinstrap and Gentoo Penguins at Palmer Station LTER&quot;&quot;&quot;</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[:]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f506d6c57a699e434dd8b89840ec9143232e55f7caf10b8777976db74b77d978.png" src="../_images/f506d6c57a699e434dd8b89840ec9143232e55f7caf10b8777976db74b77d978.png" />
</div>
</div>
<p>Now that the border is gone, the tick marks on each axis look strange, and they
don’t add any information since the grid lines are there. You can hide the tick
marks while keeping the labels by setting the lengths of the tick marks to 0.
To do this, use the <code class="docutils literal notranslate"><span class="pre">.tick_params</span></code> method, which controls parameters related to
tick marks, such as their <code class="docutils literal notranslate"><span class="pre">length</span></code>.</p>
<p>Another issue with the tick marks is that more of them are labeled on the
y-axis than in <a class="reference internal" href="#flipper-bill"><span class="std std-numref">Fig. 5.2</span></a>, and it makes the y-axis look cluttered.
You can fix problems with the positioning of tick marks on an axis with the
<code class="docutils literal notranslate"><span class="pre">.set_xticks</span></code> and <code class="docutils literal notranslate"><span class="pre">.set_yticks</span></code> method.</p>
<p>This final version of the Palmer Penguins scatter plot fixes the tick marks:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">layout</span> <span class="o">=</span> <span class="s2">&quot;constrained&quot;</span><span class="p">)</span>

<span class="n">groups</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Adelie&quot;</span>    <span class="p">:</span> <span class="p">(</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="s2">&quot;#fe8700c0&quot;</span><span class="p">),</span>
    <span class="s2">&quot;Chinstrap&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="s2">&quot;^&quot;</span><span class="p">,</span> <span class="s2">&quot;#9a27efc0&quot;</span><span class="p">),</span>
    <span class="s2">&quot;Gentoo&quot;</span>    <span class="p">:</span> <span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="s2">&quot;#098b8bc0&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">species</span><span class="p">,</span> <span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span> <span class="ow">in</span> <span class="n">groups</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">penguins</span><span class="p">[</span><span class="n">penguins</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">species</span><span class="p">]</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">obs</span><span class="p">[</span><span class="s2">&quot;flipper_length_mm&quot;</span><span class="p">],</span> <span class="n">obs</span><span class="p">[</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="n">marker</span><span class="p">,</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">species</span><span class="p">)</span> 

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Penguin species&quot;</span><span class="p">,</span> <span class="n">frameon</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span> <span class="s2">&quot;both&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Flipper length (mm)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Bill length (mm)&quot;</span><span class="p">)</span>

<span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Flipper and bill length</span>
<span class="s2">Dimensions for Adelie, Chinstrap and Gentoo Penguins at Palmer Station LTER&quot;&quot;&quot;</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[:]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">length</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span> <span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="s2">&quot;both&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">minor</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.axis.YTick at 0x71de8f40ad50&gt;,
 &lt;matplotlib.axis.YTick at 0x71de8f03a490&gt;,
 &lt;matplotlib.axis.YTick at 0x71de8f03ac10&gt;,
 &lt;matplotlib.axis.YTick at 0x71de8f03b390&gt;,
 &lt;matplotlib.axis.YTick at 0x71de8f03bb10&gt;,
 &lt;matplotlib.axis.YTick at 0x71de8f0582d0&gt;,
 &lt;matplotlib.axis.YTick at 0x71de8f058a50&gt;]
</pre></div>
</div>
<img alt="../_images/97641c15998187bf52e45313dc5465a1b05a7e5002fb1a14b71fe8a5368d11c0.png" src="../_images/97641c15998187bf52e45313dc5465a1b05a7e5002fb1a14b71fe8a5368d11c0.png" />
</div>
</div>
<p>As you can see, it takes about 20-30 lines of code (or more) to create and
customize a Matplotlib visualization. In addition, Matplotlib only has built-in
plotting functions for line plots, scatter plots, bar plots, and histograms, so
any other kind of visualization requires even more work. Packages like Seaborn
and plotnine exist to address this. On the other hand, perhaps you can also see
the incredible flexibility of Matplotlib—it can be used to draw just about
anything. The remainder of this reader will mostly focus on using Matplotlib to
customize or enhance visualizations created with other packages, to have both
convenience and flexibility.</p>
<p>The formatting in this section is just the tip of the iceberg. There are many
more ways to customize Matplotlib visualizations. The <a class="reference external" href="https://matplotlib.org/stable/api/axes_api.html">documentation for the
Axes class</a> (as well as <a class="reference external" href="https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure">the Figure class</a>) is a
good place to find more formatting methods.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Integrated development environments (IDEs) such as <a class="reference external" href="http://jupyter.org/">JupyterLab</a> and <a class="reference external" href="https://code.visualstudio.com/">Visual
Studio Code</a> have a code auto-complete feature. You can use auto-complete
to discover, learn, and remind yourself of attributes and methods on Python
objects such as Figures and Axes.</p>
</div>
</section>
<section id="saving-figures">
<h3><span class="section-number">5.2.6. </span>Saving Figures<a class="headerlink" href="#saving-figures" title="Link to this heading">#</a></h3>
<p>After creating a great data visualization, you might want to save it as an
image or some other format so that you can use it in documents or share it with
other people. Fortunately, Matplotlib makes saving visualizations
straightforward. Every Figure has a <code class="docutils literal notranslate"><span class="pre">.savefig</span></code> method that saves the Figure.
The first argument is file to which to save the Figure, either as a path or as
an open file. By default, the file format is inferred from the file extension
(if present), or else a default is used (typically PNG). So to save the Palmer
Penguins scatter plot:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;penguins.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">.savefig</span></code> function has parameters to control various properties of the
saved visualization, such as the dots per inch (DPI). The <a class="reference external" href="https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure.savefig">documentation
describes these parameters</a>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Choosing an appropriate dots per inch (DPI) value is important! Generally, DPI
should be somewhere between 72 and 300, with lower values for visualizations
displayed online (to minimize file size) and higher values for visualizations
displayed in print (to maximize quality). Some academic journals request even
higher DPIs.</p>
</div>
</section>
</section>
<section id="visualization-best-practices">
<h2><span class="section-number">5.3. </span>Visualization Best Practices<a class="headerlink" href="#visualization-best-practices" title="Link to this heading">#</a></h2>
<p>Besides programming skills, to create a visualization that conveys a clear
message about a data set, you need to know graphic design best practices and
the principles of visual perception. DataLab’s <a class="reference external" href="https://ucdavisdatalab.github.io/workshop_data_viz_principles/">Principles of Data
Visualization</a> covers these important skills.</p>
<p>DataLab’s <a class="reference external" href="https://github.com/ucdavisdatalab/workshop_handouts/blob/main/src/graphics_checklist.md">Data Visualization Guidelines</a> is a concise reference and
reminder of these skills. Bookmark or print out a copy and run through the
checklist whenever you design a visualization. The case studies in the
<a class="reference internal" href="#case-studies"><span class="std std-numref">Section 5.4</span></a> show how to fix some of the issues on the checklist.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Choosing colors is often one of the visualization details that trips people up.
Matplotlib’s <a class="reference external" href="https://matplotlib.org/stable/tutorials/colors/colormaps.html">Choosing Colormaps Guide</a> is a good source of
information for what colormaps are available in Matplotlib and how to choose an
appropriate one.</p>
</div>
</section>
<section id="case-studies">
<span id="id1"></span><h2><span class="section-number">5.4. </span>Case Studies<a class="headerlink" href="#case-studies" title="Link to this heading">#</a></h2>
<p>Now that you’ve learned a little bit about how to use Matplotlib, it’s time to
put it into practice. This section presents a variety of case studies in making
visualizations, using a mix of Matplotlib and Seaborn.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the case studies use Seaborn, most of the strategies shown apply to
any Matplotlib-based visualization package. Plotting functions in these
packages often take an Axes as input or return an Axes as output. As long as
you can get access to the Axes object, you can use Matplotlib methods to
customize the plot.</p>
</div>
<section id="plotting-a-categorical-distribution">
<span id="id2"></span><h3><span class="section-number">5.4.1. </span>Plotting a Categorical Distribution<a class="headerlink" href="#plotting-a-categorical-distribution" title="Link to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This case study shows how to:</p>
<ul class="simple">
<li><p>Use Seaborn to plot the distribution of one or more categorical features</p></li>
<li><p>Use Seaborn to create faceted plots</p></li>
</ul>
</div>
<p>When you start working with a new data set, the first thing you should do is
explore (and clean) the features. Exploring the features means inspecting the
distribution of each feature, as well as checking for relationships between
features. For this case study, let’s use Seaborn and Matplotlib to explore the
categorical features in the Palmer Penguins data set from
<a class="reference internal" href="#mpl-introduction"><span class="std std-numref">Section 5.2.1</span></a>.</p>
<p>Consider the species of the penguins the data set. Are the three
species—Adélie, Chinstrap, and Gentoo—equally represented? This question is
asking how the categorical <code class="docutils literal notranslate"><span class="pre">species</span></code> feature is distributed. Tables, bar plots,
and dot plots are all good tools for examining the distribution of a single
categorical feature. Let’s make a table and a bar plot.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Inspecting data through multiple methods is a good way to verify that your code
and interpretations are correct.</p>
</div>
<p>You can use the Pandas <code class="docutils literal notranslate"><span class="pre">.value_counts</span></code> method to make a table:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">penguins</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>species
Adelie       152
Gentoo       124
Chinstrap     68
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>To make the bar plot, first import Seaborn. The conventional abbreviation for
the package is <code class="docutils literal notranslate"><span class="pre">sns</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<p>Seaborn provides two different functions for making bar plots:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">sns.barplot</span></code> function requires two features: the category for each bar
and the length of each bar. It’s best for data that’s already been grouped
and aggregated. For example, you could compute the median flipper length of
each penguin species and then plot the means with <code class="docutils literal notranslate"><span class="pre">sns.barplot</span></code>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">sns.countplot</span></code> function only requires one feature: a categorical array.
The function automatically groups and aggregates the values by counting them.
It’s best for visualizing the distribution of a categorical feature. Note
that this is purely a convenience function—you could just compute the
counts yourself and plot them with <code class="docutils literal notranslate"><span class="pre">sns.barplot</span></code>.</p></li>
</ul>
<p>Use the <code class="docutils literal notranslate"><span class="pre">sns.countplot</span></code> function to make a bar plot of the distribution of
penguin species:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">penguins</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;species&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;species&#39;, ylabel=&#39;count&#39;&gt;
</pre></div>
</div>
<img alt="../_images/22279b6a281ddd1ab31cd0f3bc3b9600a57b7a62c9dd0e66c47b1c62189ead04.png" src="../_images/22279b6a281ddd1ab31cd0f3bc3b9600a57b7a62c9dd0e66c47b1c62189ead04.png" />
</div>
</div>
<p>The function returns a Matplotlib Axes. You can use this to customize the plot.
For example, to capitalize the axis labels:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">penguins</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;species&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Species&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Count&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Count&#39;)
</pre></div>
</div>
<img alt="../_images/91a2cdd689d24644bdd5265c598e5068c1e07beb0de6f35f55916a26754fdbaf.png" src="../_images/91a2cdd689d24644bdd5265c598e5068c1e07beb0de6f35f55916a26754fdbaf.png" />
</div>
</div>
<p>Most Seaborn plotting functions also have an <code class="docutils literal notranslate"><span class="pre">ax</span></code> parameter you can use to
specify an Axes on which to plot. This makes it possible to add to existing
Axes and to customize plots produced by plotting functions that don’t return an
Axes object. Using this approach, the equivalent of the previous example is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">penguins</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;species&quot;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Species&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Count&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Count&#39;)
</pre></div>
</div>
<img alt="../_images/91a2cdd689d24644bdd5265c598e5068c1e07beb0de6f35f55916a26754fdbaf.png" src="../_images/91a2cdd689d24644bdd5265c598e5068c1e07beb0de6f35f55916a26754fdbaf.png" />
</div>
</div>
<p>Besides species, the Palmer Penguins data set also includes information about
the island where each bird was observed and the biological sex of each bird.
When a data set has multiple categorical features, it’s important to check how
the observations are grouped within them, since unbalanced groups can bias
analyses. You can use color to represent a second categorical feature in a bar
plot. Seaborn uses the <code class="docutils literal notranslate"><span class="pre">hue</span></code> parameter to link color to a feature. So to make
the bar plot show both species and sex:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">penguins</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;species&quot;</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="s2">&quot;sex&quot;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Species&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Count&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Count&#39;)
</pre></div>
</div>
<img alt="../_images/0acb8fe845307c5e50b90cda4195eb030b7bdf2a04ea6a29f0090fdf7c6ba102.png" src="../_images/0acb8fe845307c5e50b90cda4195eb030b7bdf2a04ea6a29f0090fdf7c6ba102.png" />
</div>
</div>
<p>The plot suggests the sexes are relatively well-balanced across the observed
penguins, regardless of species. Of course, there’s still the island feature to
consider.</p>
<p>A bar plot can really only summarize two features at once, and many other types
of plots are also limited to just two or three features. One way to represent
more categorical features is to use <strong>facets</strong>, side-by-side plots that each
show data for a mutually exclusive category or combination of categories.</p>
<p>Most plotting packages provide convenience functions for making faceted plots,
and Seaborn is no exception. The <a class="reference external" href="https://seaborn.pydata.org/generated/seaborn.FacetGrid.html"><code class="docutils literal notranslate"><span class="pre">sns.FacetGrid</span></code></a> function creates
a grid of plots based on one or two categorical features. You can use the
returned FacetGrid’s <code class="docutils literal notranslate"><span class="pre">.map_dataframe</span></code> method to call a plotting function for
each facet with the appropriate subsets of the data. For example, to indicate
sex by row, island by column, and use a separate bar for each species:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">FacetGrid</span><span class="p">(</span><span class="n">penguins</span><span class="p">,</span> <span class="n">row</span> <span class="o">=</span> <span class="s2">&quot;sex&quot;</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;island&quot;</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">map_dataframe</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;species&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.FacetGrid at 0x71de8637fe00&gt;
</pre></div>
</div>
<img alt="../_images/1adbba82e1fcf0b2e1c1abf199bddd879866f0930bfff2e07430979b37187107.png" src="../_images/1adbba82e1fcf0b2e1c1abf199bddd879866f0930bfff2e07430979b37187107.png" />
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">margin_titles</span></code> parameter of <code class="docutils literal notranslate"><span class="pre">sns.FacetGrid</span></code> controls whether the group
titles are placed in the margins. The default is <code class="docutils literal notranslate"><span class="pre">False</span></code>, but setting the
parameter to <code class="docutils literal notranslate"><span class="pre">True</span></code> makes the plot easier to read:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">FacetGrid</span><span class="p">(</span>
    <span class="n">penguins</span><span class="p">,</span> <span class="n">row</span> <span class="o">=</span> <span class="s2">&quot;sex&quot;</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;island&quot;</span><span class="p">,</span> <span class="n">margin_titles</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">map_dataframe</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;species&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.FacetGrid at 0x71de85bffd90&gt;
</pre></div>
</div>
<img alt="../_images/c41e4768bb1cc73f31de63afdd1ab4b3a6ab961cab7f30c2e3062e4ea9b2e6d8.png" src="../_images/c41e4768bb1cc73f31de63afdd1ab4b3a6ab961cab7f30c2e3062e4ea9b2e6d8.png" />
</div>
</div>
<p>You can use the FacetGrid method <code class="docutils literal notranslate"><span class="pre">.set_titles</span></code> to set the titles of faceted
plots. The title strings are treated as templates with some values replaced
automatically. For instance, <code class="docutils literal notranslate"><span class="pre">{row_name}</span></code> is replaced by the row’s category.
Here’s how to change the titles so that they only show the categories and not
the feature names:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">FacetGrid</span><span class="p">(</span>
    <span class="n">penguins</span><span class="p">,</span> <span class="n">row</span> <span class="o">=</span> <span class="s2">&quot;sex&quot;</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;island&quot;</span><span class="p">,</span> <span class="n">margin_titles</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">map_dataframe</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;species&quot;</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">set_titles</span><span class="p">(</span><span class="n">row_template</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{row_name}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">col_template</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{col_name}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.FacetGrid at 0x71de85857c50&gt;
</pre></div>
</div>
<img alt="../_images/5c640a4d3de0fc2bd64a631f2f0afa3718328a3238226630cc0cb1f0d0fd46bf.png" src="../_images/5c640a4d3de0fc2bd64a631f2f0afa3718328a3238226630cc0cb1f0d0fd46bf.png" />
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to change the names of the categories in a feature, do that as a
separate step before making visualizations. The <a class="reference external" href="https://pandas.pydata.org/docs/user_guide/categorical.html">Pandas documentation about
Categorical data</a> provides details about how to create categorical
features and set category names.</p>
</div>
<p>Similarly, you can use the <code class="docutils literal notranslate"><span class="pre">.set_axis_labels</span></code> to set the axis labels:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">FacetGrid</span><span class="p">(</span>
    <span class="n">penguins</span><span class="p">,</span> <span class="n">row</span> <span class="o">=</span> <span class="s2">&quot;sex&quot;</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;island&quot;</span><span class="p">,</span> <span class="n">margin_titles</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">map_dataframe</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;species&quot;</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">set_titles</span><span class="p">(</span><span class="n">row_template</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{row_name}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">col_template</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{col_name}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">set_axis_labels</span><span class="p">(</span><span class="n">x_var</span> <span class="o">=</span> <span class="s2">&quot;Species&quot;</span><span class="p">,</span> <span class="n">y_var</span> <span class="o">=</span> <span class="s2">&quot;Count&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.FacetGrid at 0x71de85302710&gt;
</pre></div>
</div>
<img alt="../_images/3e772a25b30487afb93b13abf1bfd503ba956d139d9b340e42eee54d91dbef2c.png" src="../_images/3e772a25b30487afb93b13abf1bfd503ba956d139d9b340e42eee54d91dbef2c.png" />
</div>
</div>
<p>Seaborn’s methods for creating and customizing faceted plots are convenient,
and you can read more about them in the <a class="reference external" href="https://seaborn.pydata.org/generated/seaborn.FacetGrid.html">FacetGrid documentation</a>.
Occasionally, you may need to work with the underlying Matplotlib Figure and
Axes. Fortunately, FacetGrid objects provide access to these through the
<code class="docutils literal notranslate"><span class="pre">.figure</span></code> and <code class="docutils literal notranslate"><span class="pre">.axes</span></code> attributes.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This case study focuses on categorical features and the next focuses on
continuous features. So what should you do if you have a discrete feature?</p>
<p>Discrete features share properties of categorical features (both are
enumerable) and properties of continuous features (both are quantitative). This
usually means you can choose whether to treat discrete features as categorical
or continuous. Categorical methods tend to be more appropriate for discrete
features that take relatively few distinct values, and continuous methods tend
to be more appropriate for ones that don’t.</p>
</div>
</section>
<section id="plotting-a-continuous-distribution">
<h3><span class="section-number">5.4.2. </span>Plotting a Continuous Distribution<a class="headerlink" href="#plotting-a-continuous-distribution" title="Link to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This case study shows how to:</p>
<ul class="simple">
<li><p>Use Seaborn to plot the distribution of one or more continuous features</p></li>
</ul>
</div>
<p><a class="reference internal" href="#plotting-a-categorical-distribution"><span class="std std-numref">Section 5.4.1</span></a> shows how to visualize the
distribution of a categorical feature. For this case study, let’s examine one
of the continuous features in the Palmer Penguins data set from
<a class="reference internal" href="#mpl-introduction"><span class="std std-numref">Section 5.2.1</span></a>.</p>
<p>There are many different ways to visualize continuous features, such as
histograms, density plots, box plots, violin plots, and empirical cumulative
distribution function plots. The Seaborn documentation provides a <a class="reference external" href="https://seaborn.pydata.org/tutorial/distributions.html">detailed
guide to visualizing distributions</a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <code class="docutils literal notranslate"><span class="pre">sns.displot</span></code> function can create many different kinds of distribution
plots, but it operates at the Figure level and does not accept or return an
Axes, making it difficult to customize the result. For this reason, we
recommend against using <code class="docutils literal notranslate"><span class="pre">sns.displot</span></code>.</p>
<p>If you decide to use <code class="docutils literal notranslate"><span class="pre">sns.displot</span></code> anyways, be careful not to confuse it with
<code class="docutils literal notranslate"><span class="pre">sns.distplot</span></code> (with two “t”s). Both make distribution plots, but the former
uses a new interface that’s more consistent with other Seaborn functions. You
should use the new interface (<code class="docutils literal notranslate"><span class="pre">sns.displot</span></code>) in any new code you write, as
support for the old interface may eventually end.</p>
</div>
<p>Let’s visualize the distribution of the birds’ body mass, which is recorded in
the <code class="docutils literal notranslate"><span class="pre">body_mass_g</span></code> feature. Some of Seaborn’s functions for plotting continuous
distributions are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sns.histplot</span></code> to make a histogram</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sns.kdeplot</span></code> to make a density (or “kernel density estimator”) plot</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sns.boxplot</span></code> to make a box plot</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sns.boxenplot</span></code> to make a boxen (or “letter value”) plot</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sns.ecdfplot</span></code> to make an empirical cumulative distribution function plot</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sns.violinplot</span></code> to make a violin plot</p></li>
</ul>
<p>For example, to make a histogram:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">penguins</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;body_mass_g&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;body_mass_g&#39;, ylabel=&#39;Count&#39;&gt;
</pre></div>
</div>
<img alt="../_images/cd0b6a965530ba050db14d4ee5495e82ebb616cf7bcad2129fc50105c64aaf6d.png" src="../_images/cd0b6a965530ba050db14d4ee5495e82ebb616cf7bcad2129fc50105c64aaf6d.png" />
</div>
</div>
<p>And to make a density plot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">penguins</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;body_mass_g&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;body_mass_g&#39;, ylabel=&#39;Density&#39;&gt;
</pre></div>
</div>
<img alt="../_images/2a572b89ce6855b6f91230475c5f2a1209fb7bc152f3d102777d8a344cc4bb16.png" src="../_images/2a572b89ce6855b6f91230475c5f2a1209fb7bc152f3d102777d8a344cc4bb16.png" />
</div>
</div>
<p>Like most other Seaborn plotting functions, these functions have an <code class="docutils literal notranslate"><span class="pre">ax</span></code>
parameter for the Axes on which to plot, and also returns an Axes. So to make
the x-axis label easier to read:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">penguins</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;body_mass_g&quot;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Body Mass (g)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;Body Mass (g)&#39;)
</pre></div>
</div>
<img alt="../_images/4f699af8f54b75aaf3b996371c31871ce21ce8046227797be9d3cbbe858e344a.png" src="../_images/4f699af8f54b75aaf3b996371c31871ce21ce8046227797be9d3cbbe858e344a.png" />
</div>
</div>
<p>Density plots are convenient when you want to break down the distribution of a
continuous feature across the categories of a categorical feature, because the
plot can show a separate line for each category. For instance, to group body
mass by species:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">penguins</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;body_mass_g&quot;</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="s2">&quot;species&quot;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Body Mass (g)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;Body Mass (g)&#39;)
</pre></div>
</div>
<img alt="../_images/00de067637b35a1fba146b5efe65546e9391a5601f6d6bc6833b894cba75ddd0.png" src="../_images/00de067637b35a1fba146b5efe65546e9391a5601f6d6bc6833b894cba75ddd0.png" />
</div>
</div>
<p>This makes it easy to see that Gentoo penguins typically have more mass than
the other two species.</p>
<p>As in <a class="reference internal" href="#plotting-a-categorical-distribution"><span class="std std-numref">Section 5.4.1</span></a>, you can incorporate more
categorical features by faceting. To incorporate another continuous feature,
it’s necessary to change plot types.</p>
<p>You can visualize the distributions of and relationship between two continuous
features with a scatter plot (<code class="docutils literal notranslate"><span class="pre">sns.scatterplot</span></code>) or a smoothed scatter plot
(again <code class="docutils literal notranslate"><span class="pre">sns.kdeplot</span></code>). The latter smooths out the points in a scatter plot to
show their relative density, using a 2-dimensional generalization of the method
used to estimate a density plot. For instance, to plot body weight against
flipper length:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span>
    <span class="n">penguins</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;body_mass_g&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;flipper_length_mm&quot;</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="s2">&quot;species&quot;</span><span class="p">,</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Body Mass (g)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Flipper Length (mm)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Flipper Length (mm)&#39;)
</pre></div>
</div>
<img alt="../_images/5dbac70ca151013fb97532bd5be6777afa7b3b7f6746c67729491413c059b641.png" src="../_images/5dbac70ca151013fb97532bd5be6777afa7b3b7f6746c67729491413c059b641.png" />
</div>
</div>
<p>In this plot it’s possible to see how the distributions of body mass and
flipper length differ across species, as well as how body mass and flipper mass
are related.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Visualizing more than two continuous features at once can be challenging. One
way to get around this problem is to create a separate plot for each pair of
features.</p>
<p>If it really is necessary to visualize more than two at once, consider
converting at least one of them into a categorical feature by <strong>binning</strong> or
<strong>discretizing</strong> the values. Then you can use strategies for categorical
features such as varying colors and faceting.</p>
</div>
</section>
<section id="plotting-a-time-series">
<h3><span class="section-number">5.4.3. </span>Plotting a Time Series<a class="headerlink" href="#plotting-a-time-series" title="Link to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This case study shows how to:</p>
<ul class="simple">
<li><p>Convert temporal data to appropriate data types</p></li>
<li><p>Use Seaborn to plot a time series as a histogram or a line</p></li>
<li><p>Use multiple data sets in a single plot</p></li>
<li><p>Customize and rotate the text of tick labels</p></li>
<li><p>Move a legend on a Seaborn plot</p></li>
</ul>
</div>
<p>Plotting a time series can be tricky because you first need to make sure that
the temporal features have appropriate data types. For this case study, suppose
you want to make a visualization that shows the relationship between flu rates
in birds and humans.</p>
<p>People mail dead birds to the USDA and USGS, where scientists analyze the birds
to find out why they died. The USDA compiles the information into a public
<a class="reference external" href="https://www.aphis.usda.gov/aphis/ourfocus/animalhealth/animal-disease-information/avian/avian-influenza/">Avian Influenza data set</a> each year.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>You can download the Avian Influenza data <a class="reference external" href="https://ucdavis.box.com/s/babz1b5ak0kh7q7cktg7k5gzrt2ve9gc">HERE</a>.</p>
</div>
<p>You can use pandas’ <code class="docutils literal notranslate"><span class="pre">pd.read_csv</span></code> function to read the data. Each row
corresponds to one bird death. There are 8 columns with information about the
date, species of bird, collection method, and location. The <code class="docutils literal notranslate"><span class="pre">Date</span> <span class="pre">Detected</span></code>
column is a date, while the rest of the columns are categorical, which you can
see by taking a peek at the data set:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/hpai-wild-birds-ver2.csv&quot;</span><span class="p">,</span> <span class="n">nrows</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>County</th>
      <th>Date Detected</th>
      <th>HPAI Strain</th>
      <th>Bird Species</th>
      <th>WOAH Classification</th>
      <th>Sampling Method</th>
      <th>Submitting Agency</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>South Carolina</td>
      <td>Colleton</td>
      <td>1/13/2022</td>
      <td>EA H5N1</td>
      <td>American wigeon</td>
      <td>Wild bird</td>
      <td>Hunter harvest</td>
      <td>NWDP</td>
    </tr>
    <tr>
      <th>1</th>
      <td>South Carolina</td>
      <td>Colleton</td>
      <td>1/13/2022</td>
      <td>EA H5N1</td>
      <td>Blue-winged teal</td>
      <td>Wild bird</td>
      <td>Hunter harvest</td>
      <td>NWDP</td>
    </tr>
    <tr>
      <th>2</th>
      <td>North Carolina</td>
      <td>Hyde</td>
      <td>1/12/2022</td>
      <td>EA H5N1</td>
      <td>Northern shoveler</td>
      <td>Wild bird</td>
      <td>Hunter harvest</td>
      <td>NWDP</td>
    </tr>
    <tr>
      <th>3</th>
      <td>North Carolina</td>
      <td>Hyde</td>
      <td>1/20/2022</td>
      <td>EA H5N1</td>
      <td>American wigeon</td>
      <td>Wild bird</td>
      <td>Hunter harvest</td>
      <td>NWDP</td>
    </tr>
    <tr>
      <th>4</th>
      <td>North Carolina</td>
      <td>Hyde</td>
      <td>1/20/2022</td>
      <td>EA H5</td>
      <td>Gadwall</td>
      <td>Wild bird</td>
      <td>Hunter harvest</td>
      <td>NWDP</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To parse the dates, set the <code class="docutils literal notranslate"><span class="pre">pd.read_csv</span></code> function’s <code class="docutils literal notranslate"><span class="pre">parse_dates</span></code> parameter to
a list of date columns to parse. You can also set the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> parameter to data
types for other columns, either as a dictionary with one entry per column, or a
string default type. So to read the date column as dates and the rest as
categories:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">birds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;data/hpai-wild-birds-ver2.csv&quot;</span><span class="p">,</span>
    <span class="n">parse_dates</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Date Detected&quot;</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s2">&quot;category&quot;</span><span class="p">)</span>

<span class="n">birds</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 6542 entries, 0 to 6541
Data columns (total 8 columns):
 #   Column               Non-Null Count  Dtype         
---  ------               --------------  -----         
 0   State                6542 non-null   category      
 1   County               6542 non-null   category      
 2   Date Detected        6540 non-null   datetime64[ns]
 3   HPAI Strain          6541 non-null   category      
 4   Bird Species         6542 non-null   category      
 5   WOAH Classification  6542 non-null   category      
 6   Sampling Method      6542 non-null   category      
 7   Submitting Agency    6542 non-null   category      
dtypes: category(7), datetime64[ns](1)
memory usage: 144.6 KB
</pre></div>
</div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It’s also possible to parse dates in pandas with the <code class="docutils literal notranslate"><span class="pre">pd.to_datetime</span></code> function,
and to convert columns to other data types with the <code class="docutils literal notranslate"><span class="pre">.astype</span></code> method.</p>
<p>Specifying appropriate data types when you read data often provides performance
benefits, but doing data type conversions later gives you more flexibility to
clean the data first. So which approach you should use in any given situation
depends on the data set and your analysis goals.</p>
</div>
<p>What kind of plot is appropriate for this data set? Note that there are several
dates where more than one bird was collected:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">birds</span><span class="p">[</span><span class="s2">&quot;Date Detected&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date Detected
2022-10-25    366
2022-11-21    148
2022-09-13    129
2022-09-23    128
2022-02-16    109
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>While you could use a line plot to show the counts for each date, there are
also many dates where the counts are zero. To see a smoothed out version of the
line plot, you can use a histogram of the observations. In Seaborn, the
<code class="docutils literal notranslate"><span class="pre">sns.histplot</span></code> function makes a histogram (and returns a Matplotlib Axes):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">birds</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Date Detected&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/43b8e6555ac366c583c6bb428b8b1175b2b562ac28c47c6326a04d6909c31d4f.png" src="../_images/43b8e6555ac366c583c6bb428b8b1175b2b562ac28c47c6326a04d6909c31d4f.png" />
</div>
</div>
<p>Depending on how wide your screen is, the x-axis tick labels may get squeezed
together, making them difficult to read. This problem is especially common when
plotting dates, since the labels tend to be long. One way to fix it is to
rotate the labels. With Matplotlib, you can use the Axes method <code class="docutils literal notranslate"><span class="pre">.set_xticks</span></code>
(or <code class="docutils literal notranslate"><span class="pre">.set_yticks</span></code>) to control properties of the ticks and tick labels. The
first two arguments to the function are the tick positions and tick labels; you
can get the default values with the <code class="docutils literal notranslate"><span class="pre">.get_xticks</span></code> and <code class="docutils literal notranslate"><span class="pre">.get_xticklabels</span></code>
methods. The <code class="docutils literal notranslate"><span class="pre">rotation</span></code> parameter controls the degree of rotation. So to make
the histogram with the x-axis tick labels at 45 degrees:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">birds</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Date Detected&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">(),</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span> <span class="o">=</span> <span class="mi">45</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.axis.XTick at 0x71de84d96fd0&gt;,
 &lt;matplotlib.axis.XTick at 0x71de84dcb250&gt;,
 &lt;matplotlib.axis.XTick at 0x71de84dcb9d0&gt;,
 &lt;matplotlib.axis.XTick at 0x71de84c28190&gt;,
 &lt;matplotlib.axis.XTick at 0x71de84c28910&gt;,
 &lt;matplotlib.axis.XTick at 0x71de84c29090&gt;,
 &lt;matplotlib.axis.XTick at 0x71de84c29810&gt;,
 &lt;matplotlib.axis.XTick at 0x71de84c29f90&gt;,
 &lt;matplotlib.axis.XTick at 0x71de84c2a710&gt;]
</pre></div>
</div>
<img alt="../_images/1ba86db74c94ced016430a775afabafac95bbf4211fe6d46dce2d093ee4deb7f.png" src="../_images/1ba86db74c94ced016430a775afabafac95bbf4211fe6d46dce2d093ee4deb7f.png" />
</div>
</div>
<p>The rotation interferes with the horizontal alignment of the tick labels, so
they’re positioned too far to the right. To fix this, set the horizontal
alignment parameter <code class="docutils literal notranslate"><span class="pre">ha</span></code> to <code class="docutils literal notranslate"><span class="pre">&quot;right&quot;</span></code> and set the rotation mode parameter
<code class="docutils literal notranslate"><span class="pre">rotation_mode</span></code> to <code class="docutils literal notranslate"><span class="pre">&quot;anchor&quot;</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">birds</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Date Detected&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">(),</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span> <span class="o">=</span> <span class="mi">45</span><span class="p">,</span> <span class="n">ha</span> <span class="o">=</span> <span class="s2">&quot;right&quot;</span><span class="p">,</span>
    <span class="n">rotation_mode</span> <span class="o">=</span> <span class="s2">&quot;anchor&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.axis.XTick at 0x71de84c4f890&gt;,
 &lt;matplotlib.axis.XTick at 0x71de84c87750&gt;,
 &lt;matplotlib.axis.XTick at 0x71de84c87ed0&gt;,
 &lt;matplotlib.axis.XTick at 0x71de84cd0690&gt;,
 &lt;matplotlib.axis.XTick at 0x71de84cd0e10&gt;,
 &lt;matplotlib.axis.XTick at 0x71de84cd1590&gt;,
 &lt;matplotlib.axis.XTick at 0x71de84cd1d10&gt;,
 &lt;matplotlib.axis.XTick at 0x71de84cd2490&gt;,
 &lt;matplotlib.axis.XTick at 0x71de84cd2c10&gt;]
</pre></div>
</div>
<img alt="../_images/aaf193589d22169c2caa44f25365f3dfad4fec8300aa3a644c583b5ef2d2bf12.png" src="../_images/aaf193589d22169c2caa44f25365f3dfad4fec8300aa3a644c583b5ef2d2bf12.png" />
</div>
</div>
<p>The data set includes information about how the birds were collected in the
<code class="docutils literal notranslate"><span class="pre">Sampling</span> <span class="pre">Method</span></code> column. You can incorporate this information in the plot by
setting the <code class="docutils literal notranslate"><span class="pre">hue</span></code> parameter in the call to <code class="docutils literal notranslate"><span class="pre">sns.histplot</span></code>. In this case,
stacked bars are a good choice since the focus is on the total counts for each
date range rather than the individual sampling methods. You can make the bars
stack by setting the <code class="docutils literal notranslate"><span class="pre">multiple</span></code> parameter to <code class="docutils literal notranslate"><span class="pre">&quot;stack&quot;</span></code>. The code becomes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="n">birds</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Date Detected&quot;</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="s2">&quot;Sampling Method&quot;</span><span class="p">,</span> <span class="n">multiple</span> <span class="o">=</span> <span class="s2">&quot;stack&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">(),</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span> <span class="o">=</span> <span class="mi">45</span><span class="p">,</span> <span class="n">ha</span> <span class="o">=</span> <span class="s2">&quot;right&quot;</span><span class="p">,</span>
    <span class="n">rotation_mode</span> <span class="o">=</span> <span class="s2">&quot;anchor&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.axis.XTick at 0x71de84b18190&gt;,
 &lt;matplotlib.axis.XTick at 0x71de84be7110&gt;,
 &lt;matplotlib.axis.XTick at 0x71de84be7890&gt;,
 &lt;matplotlib.axis.XTick at 0x71de84a34050&gt;,
 &lt;matplotlib.axis.XTick at 0x71de84a347d0&gt;,
 &lt;matplotlib.axis.XTick at 0x71de84a34f50&gt;,
 &lt;matplotlib.axis.XTick at 0x71de84a356d0&gt;,
 &lt;matplotlib.axis.XTick at 0x71de84a35e50&gt;,
 &lt;matplotlib.axis.XTick at 0x71de84a365d0&gt;]
</pre></div>
</div>
<img alt="../_images/3124f378b30e055094748da496046a78a550b297d021ac63a06b7f177509b291.png" src="../_images/3124f378b30e055094748da496046a78a550b297d021ac63a06b7f177509b291.png" />
</div>
</div>
<p>Seaborn automatically creates a legend, but the placement on top of the plot
isn’t ideal. While you could create the legend manually with Matplotlib
instead, in this case it’s easier to use Seaborn’s <a class="reference external" href="https://seaborn.pydata.org/generated/seaborn.move_legend.html?highlight=move_legend#seaborn.move_legend"><code class="docutils literal notranslate"><span class="pre">sns.move_legend</span></code>
function</a> to move the legend:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="n">birds</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Date Detected&quot;</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="s2">&quot;Sampling Method&quot;</span><span class="p">,</span> <span class="n">multiple</span> <span class="o">=</span> <span class="s2">&quot;stack&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">(),</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span> <span class="o">=</span> <span class="mi">45</span><span class="p">,</span> <span class="n">ha</span> <span class="o">=</span> <span class="s2">&quot;right&quot;</span><span class="p">,</span>
    <span class="n">rotation_mode</span> <span class="o">=</span> <span class="s2">&quot;anchor&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">move_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="s2">&quot;center left&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/016bab35765f493fb3dc1f69e2ca4dc0eee919e1b8c7f0fedf1f4c5333a1dfd0.png" src="../_images/016bab35765f493fb3dc1f69e2ca4dc0eee919e1b8c7f0fedf1f4c5333a1dfd0.png" />
</div>
</div>
<p>The plot looks good, so now let’s add data about human flu rates. The CDC
collects data about flu hospitalizations across 13 states. The data is publicly
available as the <a class="reference external" href="https://gis.cdc.gov/GRASP/Fluview/FluHospRates.html">FluServ-NET data set</a>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>You can download the FluServ-NET data <a class="reference external" href="https://ucdavis.box.com/s/a4m4ermwm0lqes2sh1jckdf16h0rpdkc">HERE</a>.</p>
</div>
<p>In the FluServ-NET data set, each row corresponds to a single combination of
week, year, age, sex, and race. There are 10 columns, which are a mix of data
types. The CSV file the CDC provides contains extra text at the beginning and
end, and the column names contain spaces and other problematic characters. You
can read and clean up the data set with this code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flu</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;data/FluSurveillance_Custom_Download_Data.csv&quot;</span><span class="p">,</span> <span class="n">skiprows</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">flu</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CATCHMENT</th>
      <th>NETWORK</th>
      <th>YEAR</th>
      <th>MMWR-YEAR</th>
      <th>MMWR-WEEK</th>
      <th>AGE CATEGORY</th>
      <th>SEX CATEGORY</th>
      <th>RACE CATEGORY</th>
      <th>CUMULATIVE RATE</th>
      <th>WEEKLY RATE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Entire Network</td>
      <td>FluSurv-NET</td>
      <td>2021-22</td>
      <td>2021.0</td>
      <td>40.0</td>
      <td>Overall</td>
      <td>Overall</td>
      <td>Overall</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Entire Network</td>
      <td>FluSurv-NET</td>
      <td>2021-22</td>
      <td>2021.0</td>
      <td>40.0</td>
      <td>Overall</td>
      <td>Overall</td>
      <td>White</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Entire Network</td>
      <td>FluSurv-NET</td>
      <td>2021-22</td>
      <td>2021.0</td>
      <td>40.0</td>
      <td>Overall</td>
      <td>Overall</td>
      <td>Black</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Entire Network</td>
      <td>FluSurv-NET</td>
      <td>2021-22</td>
      <td>2021.0</td>
      <td>40.0</td>
      <td>Overall</td>
      <td>Overall</td>
      <td>Hispanic/Latino</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Entire Network</td>
      <td>FluSurv-NET</td>
      <td>2021-22</td>
      <td>2021.0</td>
      <td>40.0</td>
      <td>Overall</td>
      <td>Overall</td>
      <td>Asian/Pacific Islander</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fix the column names.</span>
<span class="n">flu</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="n">flu</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[ -]+&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="n">regex</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># Remove the text at the end.</span>
<span class="n">flu</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;catchment == &#39;Entire Network&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>For the plot, you’ll only need the <code class="docutils literal notranslate"><span class="pre">&quot;Overall&quot;</span></code> age, sex, and race categories:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flu</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
    <span class="s2">&quot;age_category == &#39;Overall&#39; and sex_category == &#39;Overall&#39; and &quot;</span>
    <span class="s2">&quot;race_category == &#39;Overall&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>You can convert each year and week pair into a date by concatenating them and
then parsing with the <code class="docutils literal notranslate"><span class="pre">pd.to_datetime</span></code> function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dates</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">flu</span><span class="p">[</span><span class="s2">&quot;mmwr_year&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">flu</span><span class="p">[</span><span class="s2">&quot;mmwr_week&quot;</span><span class="p">]</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">dates</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">flu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s2">&quot;%Y%W%w&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, you can add a line for the weekly flu rates in the <code class="docutils literal notranslate"><span class="pre">weekly_rate</span></code>
column with the <code class="docutils literal notranslate"><span class="pre">.plot</span></code> method. The weekly flu rates are measured in
hospitalizations per 100,000 people and typically range from 0 to 100.
Multiplying by 100 to convert to hospitalizations per 10 million people makes
the range 0 to 1000, which is a nice match for the y-axis already on the plot.
The code becomes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="n">birds</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Date Detected&quot;</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="s2">&quot;Sampling Method&quot;</span><span class="p">,</span> <span class="n">multiple</span> <span class="o">=</span> <span class="s2">&quot;stack&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">(),</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span> <span class="o">=</span> <span class="mi">45</span><span class="p">,</span> <span class="n">ha</span> <span class="o">=</span> <span class="s2">&quot;right&quot;</span><span class="p">,</span>
    <span class="n">rotation_mode</span> <span class="o">=</span> <span class="s2">&quot;anchor&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">move_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="s2">&quot;center left&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">flu</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">],</span> <span class="n">flu</span><span class="p">[</span><span class="s2">&quot;weekly_rate&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#000000&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x71de84781d10&gt;]
</pre></div>
</div>
<img alt="../_images/7b5c1345e78f1b2a7ba5d4c6b0a720dd1ee849e347fdc3c78d26d507ad697003.png" src="../_images/7b5c1345e78f1b2a7ba5d4c6b0a720dd1ee849e347fdc3c78d26d507ad697003.png" />
</div>
</div>
<p>Finally, add a title and clarify what the y-axis means:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="n">birds</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Date Detected&quot;</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="s2">&quot;Sampling Method&quot;</span><span class="p">,</span> <span class="n">multiple</span> <span class="o">=</span> <span class="s2">&quot;stack&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">(),</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span> <span class="o">=</span> <span class="mi">45</span><span class="p">,</span> <span class="n">ha</span> <span class="o">=</span> <span class="s2">&quot;right&quot;</span><span class="p">,</span>
    <span class="n">rotation_mode</span> <span class="o">=</span> <span class="s2">&quot;anchor&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">move_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="s2">&quot;center left&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">flu</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">],</span> <span class="n">flu</span><span class="p">[</span><span class="s2">&quot;weekly_rate&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#000000&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Flu Rates for Birds and Humans&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Reported bird deaths</span><span class="se">\n</span><span class="s2">Hospitalizations per 10 million people&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Reported bird deaths\nHospitalizations per 10 million people&#39;)
</pre></div>
</div>
<img alt="../_images/9816ab7790b21a8dd48be79960286bad635ec0299132e45399f8d8e90cea8ec5.png" src="../_images/9816ab7790b21a8dd48be79960286bad635ec0299132e45399f8d8e90cea8ec5.png" />
</div>
</div>
</section>
<section id="plotting-a-function">
<h3><span class="section-number">5.4.4. </span>Plotting a Function<a class="headerlink" href="#plotting-a-function" title="Link to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This case study shows how to:</p>
<ul class="simple">
<li><p>Plot a function</p></li>
<li><p>Fill the area under a function</p></li>
<li><p>Set custom colors for lines, fills, and annotations</p></li>
<li><p>Hide the axes of a plot</p></li>
<li><p>Add annotations to a plot</p></li>
</ul>
</div>
<p>Plotting a curve or function can make it much easier to understand and explain
its behavior. For this case study, suppose you want to make a visualization
that shows how the area of overlap between two different probability density
functions is a measure of how similar they are. They should have some overlap,
but not too much. The color palette should be UC blue (<code class="docutils literal notranslate"><span class="pre">#1a3f68</span></code>) and gold
(<code class="docutils literal notranslate"><span class="pre">#e6c257</span></code>) to match the rest of your presentation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A <em>probability density function</em> is a function that shows how likely different
outcomes are for a continuous probability distribution. The probability of
outcomes in any given interval is the area under the curve. For example, if the
area under the curve between 0 and 1 is 0.2, then there’s a 20% chance of an
outcome between 0 and 1. The total area under the curve is always 1.</p>
<p>Since the total area under a probability density function is always 1, the area
of overlap between two density functions is always between 0 and 1. As a
result, the area of overlap is a convenient measure of similarity.</p>
</div>
<p>To plot a function, first evaluate it at many points over the interval of
interest. Let’s start with 1,000 points in the interval <span class="math notranslate nohighlight">\((-20, 20)\)</span>. You can
use NumPy’s <code class="docutils literal notranslate"><span class="pre">np.linspace</span></code> function to compute evenly spaced points:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The SciPy package provides probability density functions for common
distributions. Let’s use a normal distribution and a gamma distribution. Normal
distributions are widely known, while gamma distributions are visually
different but will still have some overlap. You can import the probability
density functions for these distributions from <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code>. The gamma
distribution requires a shape parameter; let’s use 10. Evaluate functions the
at the x-coordinates:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">norm</span><span class="p">,</span> <span class="n">gamma</span>

<span class="n">y1</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>You can use Matplotlib to plot the <span class="math notranslate nohighlight">\((x, y)\)</span> coordinates as lines. The <code class="docutils literal notranslate"><span class="pre">.plot</span></code>
method creates a line plot by default. Set the <code class="docutils literal notranslate"><span class="pre">linestyle</span></code> parameter on one of
the lines to a dash (<code class="docutils literal notranslate"><span class="pre">--</span></code>) so that the lines are distinct:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s2">&quot;--&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x71de8453da90&gt;]
</pre></div>
</div>
<img alt="../_images/08907e8e5c7f45a6585ccf24d94d62d8833d0473c31171e983ac8f4d02098a26.png" src="../_images/08907e8e5c7f45a6585ccf24d94d62d8833d0473c31171e983ac8f4d02098a26.png" />
</div>
</div>
<p>The two distributions don’t overlap much, but you can fix that by adjusting
their parameters. SciPy provides location (<code class="docutils literal notranslate"><span class="pre">loc</span></code>) and scale (<code class="docutils literal notranslate"><span class="pre">scale</span></code>)
parameters to control where distributions are located and how much they spread
out. The defaults are 0 and 1, respectively. To get some overlap, let’s
increase the scale of the normal distribution to 4 and shift the location of
the gamma distribution over to -2. Then the code for the plot becomes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s2">&quot;--&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x71de845c6710&gt;]
</pre></div>
</div>
<img alt="../_images/0608956cb308baf64ab6b6d92cfe137f367f483da74deac996f9a5ae5fb5afd0.png" src="../_images/0608956cb308baf64ab6b6d92cfe137f367f483da74deac996f9a5ae5fb5afd0.png" />
</div>
</div>
<p>Let’s emphasize the overlap by filling it with a color. Axes have a
<code class="docutils literal notranslate"><span class="pre">.fill_between</span></code> method that fills the area underneath a curve. In this case,
the area of overlap is the area underneath whichever function happens to be
smaller at a given point—the minimum of the two functions. NumPy’s <code class="docutils literal notranslate"><span class="pre">np.fmin</span></code>
function computes the element-wise minimum of two arrays. So the code becomes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s2">&quot;--&quot;</span><span class="p">)</span>

<span class="c1"># Fill area of overlap.</span>
<span class="n">ymin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fmin</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ymin</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.FillBetweenPolyCollection at 0x71de8627dd30&gt;
</pre></div>
</div>
<img alt="../_images/bed2a5fe59aaec447ae27beaad6dbc236027d70058523c6666b329d56138dcfb.png" src="../_images/bed2a5fe59aaec447ae27beaad6dbc236027d70058523c6666b329d56138dcfb.png" />
</div>
</div>
<p>This diagram is meant to make it easier to explain area of overlap, which is
shown by the curves and fill. The axis ticks and labels don’t aid
understanding, so let’s remove them. You can use the Axes <code class="docutils literal notranslate"><span class="pre">.axis</span></code> method with
the argument <code class="docutils literal notranslate"><span class="pre">&quot;off&quot;</span></code> to do so. Let’s adjust the x interval to <span class="math notranslate nohighlight">\((-15, 25)\)</span> to
center the curves, change the color to UC blue for the lines, and change the
color to UC gold for the fill:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#1a3f68&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#1a3f68&quot;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s2">&quot;--&quot;</span><span class="p">)</span>

<span class="c1"># Fill area of overlap.</span>
<span class="n">ymin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fmin</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#e6c257&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(np.float64(-17.0),
 np.float64(27.0),
 np.float64(-0.006587663025137597),
 np.float64(0.13834092352788954))
</pre></div>
</div>
<img alt="../_images/cf8657c6866dee02e01911b90a60cc9e96998308540aa2790d3a35437809f158.png" src="../_images/cf8657c6866dee02e01911b90a60cc9e96998308540aa2790d3a35437809f158.png" />
</div>
</div>
<p>Finally, let’s add a text label and arrow to emphasize the area of overlap. You
can use the <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.annotate.html#matplotlib.axes.Axes.annotate"><code class="docutils literal notranslate"><span class="pre">.annotate</span></code> method</a> to add an annotation to an Axes.
Annotations are flexible: they can be lines, arrows, text, images, or some
combination of these.</p>
<p>For making a text label and arrow with <code class="docutils literal notranslate"><span class="pre">.annotate</span></code>, the following parameters
are important:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">text</span></code>: the text of the label, as a string</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">xy</span></code>: the coordinates of the arrow’s tip, as a tuple</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">xytext</span></code>: the coordinates of the text and the arrow’s tail, as a tuple</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">xycoords</span></code>: a string that specifies the coordinate system; for example, the
default <code class="docutils literal notranslate"><span class="pre">&quot;data&quot;</span></code> uses the data’s coordinate system, while <code class="docutils literal notranslate"><span class="pre">&quot;axes</span> <span class="pre">fraction&quot;</span></code>
uses 0 to 1 along each axis, so <span class="math notranslate nohighlight">\((0.5, 0.5)\)</span> is the center; see <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.annotate.html#matplotlib.axes.Axes.annotate">the
documentation</a> for all possible options</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">color</span></code>: the color of the text (but not the arrow), as a string</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">arrowprops</span></code>: a dictionary with properties for the arrow, such as:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">arrowstyle</span></code>: a string that specifies the arrow’s head and line style</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">color</span></code>: the color of the arrow, as a string</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">fontsize</span></code>: the point size of the text, as an integer</p></li>
</ul>
<p>With the annotation, the plot becomes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#1a3f68&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#1a3f68&quot;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s2">&quot;--&quot;</span><span class="p">)</span>

<span class="c1"># Fill area of overlap.</span>
<span class="n">ymin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fmin</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#e6c257&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;overlap&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#1a3f68&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">),</span> <span class="n">xytext</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">),</span> <span class="n">xycoords</span> <span class="o">=</span> <span class="s2">&quot;axes fraction&quot;</span><span class="p">,</span>
    <span class="n">arrowprops</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#1a3f68&quot;</span><span class="p">,</span> <span class="s2">&quot;arrowstyle&quot;</span><span class="p">:</span> <span class="s2">&quot;-&gt;&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.75, 0.75, &#39;overlap&#39;)
</pre></div>
</div>
<img alt="../_images/2bf3b13c1d937a6359b78325384e661694b1c3cd7e3c380a9df77d59e8fbc695.png" src="../_images/2bf3b13c1d937a6359b78325384e661694b1c3cd7e3c380a9df77d59e8fbc695.png" />
</div>
</div>
</section>
<section id="plotting-an-image">
<h3><span class="section-number">5.4.5. </span>Plotting an Image<a class="headerlink" href="#plotting-an-image" title="Link to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This case study shows how to:</p>
<ul class="simple">
<li><p>Plot an image</p></li>
<li><p>Plot other shapes on top of an image, such as rectangles</p></li>
</ul>
</div>
<p>Image data sets are common in many disciplines. For example, a radiologist
might have a collection of x-ray images. For these data sets, being able to
display and annotate images is extremely helpful. In this case study, suppose
you want to display the picture of American Bison in <a class="reference internal" href="#bison"><span class="std std-numref">Fig. 5.4</span></a> and add a
box around each animal.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>You can download the American Bison image by right-clicking on the image in
<a class="reference internal" href="#bison"><span class="std std-numref">Fig. 5.4</span></a> and selecting <code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">Image</span> <span class="pre">As...</span></code> from the context menu.</p>
</div>
<figure class="align-default" id="bison">
<img alt="../_images/bison.png" src="../_images/bison.png" />
<figcaption>
<p><span class="caption-number">Fig. 5.4 </span><span class="caption-text">American Bison</span><a class="headerlink" href="#bison" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The first step is to read the image into Python. The <a class="reference external" href="https://pillow.readthedocs.io/en/stable/">Pillow</a> package
provides functions for reading, editing, and writing images. The package is a
fork (an alternative version) of the older Python Imaging Library (PIL), and
still uses the PIL name in Python code. Import the <code class="docutils literal notranslate"><span class="pre">Image</span></code> class from the
package:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
</pre></div>
</div>
</div>
</div>
<p>You can use the Image method <code class="docutils literal notranslate"><span class="pre">.open</span></code> to read the image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;data/bison.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In computing contexts, an image is typically represented by an array of color
values. Grayscale images can be represented by a 2-dimensional matrix, but
color images require an extra dimension for the red, green, and blue channels.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">.imshow</span></code> method expects an image with dimensions:</p>
<div class="math notranslate nohighlight">
\[
\textrm{width} \times \textrm{height} \times \textrm{channel}
\]</div>
<p>The channel dimension should have 3 elements: red, green, and blue, in that
order. The <code class="docutils literal notranslate"><span class="pre">.imshow</span></code> method also works with grayscale images that only have 2
dimensions.</p>
<p>If you try to plot an image with <code class="docutils literal notranslate"><span class="pre">.imshow</span></code> and Python raises an error or the
image looks strange (especially the colors), the first thing to check is
whether the image has the right dimensions and color channels. You can usually
fix any problems with the functions NumPy and Pillow provide to reshape arrays
and convert between different color spaces.</p>
</div>
<p>The Axes method <code class="docutils literal notranslate"><span class="pre">.imshow</span></code> plots an image. As usual, use <code class="docutils literal notranslate"><span class="pre">plt.subplots</span></code> to set
up a Figure and Axes before plotting:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x71de8627e270&gt;
</pre></div>
</div>
<img alt="../_images/3fcd8436ec04752306593fe0a8b7f220fd5fac4f2adbed5c73a5ac8da973d555.png" src="../_images/3fcd8436ec04752306593fe0a8b7f220fd5fac4f2adbed5c73a5ac8da973d555.png" />
</div>
</div>
<p>Now let’s add a red rectangle around the bison in the foreground. In Matplotlib
terminology, a 2-dimensional geometric shape is a <code class="docutils literal notranslate"><span class="pre">Patch</span></code>, and a <code class="docutils literal notranslate"><span class="pre">Rectangle</span></code>
is a specific kind of Patch. To create a rectangle, import <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> and use
the <code class="docutils literal notranslate"><span class="pre">patches.Rectangle</span></code> constructor function. The function’s first argument is
a tuple with the top left coordinates of the rectangle. You can use separate
arguments to specify the width and height. For the bison image, position the
rectangle at <code class="docutils literal notranslate"><span class="pre">(120,</span> <span class="pre">200)</span></code>, make the width <code class="docutils literal notranslate"><span class="pre">140</span></code>, and make the height <code class="docutils literal notranslate"><span class="pre">160</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpl</span>

<span class="n">rect</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">120</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">140</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">160</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To add a Patch to a plot, use the Axes method <code class="docutils literal notranslate"><span class="pre">.add_patch</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="c1"># Add rectangle.</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.patches.Rectangle at 0x71de843a1a90&gt;
</pre></div>
</div>
<img alt="../_images/9567f3ba1e25a6f650d30a011930d5ef08a19742a6ba9e021589b7aa865b5b0c.png" src="../_images/9567f3ba1e25a6f650d30a011930d5ef08a19742a6ba9e021589b7aa865b5b0c.png" />
</div>
</div>
<p>By default, patches are filled in blue, but you can change the fill and edge
colors by setting the <code class="docutils literal notranslate"><span class="pre">facecolor</span></code> and <code class="docutils literal notranslate"><span class="pre">edgecolor</span></code> arguments when you create the
Patch. The special color <code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code> is fully transparent. So to make the
rectangle have transparent fill and red edges:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rect</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span>
    <span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">140</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">160</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span>
    <span class="n">edgecolor</span> <span class="o">=</span> <span class="s2">&quot;#FF0000&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="c1"># Add rectangle.</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.patches.Rectangle at 0x71de84221810&gt;
</pre></div>
</div>
<img alt="../_images/6682544e40a56a53e79dcd88507b83e15c95736696eb0186f0c0b53eb4bbac42.png" src="../_images/6682544e40a56a53e79dcd88507b83e15c95736696eb0186f0c0b53eb4bbac42.png" />
</div>
</div>
<p>You can create and add as many patches as needed to a plot. If you need to add
lots of patches, consider whether it’s possible to use a loop. Image
annotations are especially useful for displaying results from image processing
and machine learning algorithms.</p>
</section>
<section id="plotting-a-map">
<h3><span class="section-number">5.4.6. </span>Plotting a Map<a class="headerlink" href="#plotting-a-map" title="Link to this heading">#</a></h3>
<p>Geospatial data are often best visualized by making a map. When you make a map,
visualization best practices still apply, but there are also many additional
details to consider, such as what projection to use. The <a class="reference external" href="https://geopandas.org/en/stable/">GeoPandas</a> package
provides functions to read and visualize geospatial data. Like many other
packages, the GeoPandas visualization functions are built on Matplotlib, so you
can use the customization strategies described in this reader. No case study is
provided here because working with geospatial data requires specialized
knowledge that goes beyond the focus of this chapter.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you work with geospatial data frequently or need to make publication-quality
maps, it may be better to use dedicated geospatial software, such as <a class="reference external" href="https://qgis.org/en/site/">QGIS</a>.
DataLab’s <a class="reference external" href="https://ucdavisdatalab.github.io/Intro-to-Desktop-GIS-with-QGIS/">Intro to Desktop GIS with QGIS</a> workshop provides an
introduction.</p>
</div>
<!--
### Egg Prices

```{code-cell}
eggs = pd.read_csv("data/eggs.csv")

# Rotate monthly price columns into a `Month` and a `Price` column. 
eggs = eggs.melt(id_vars = "Year", var_name = "Month", value_name = "Price")

# 
eggs["Price"] = eggs["Price"].astype("string")
is_num = eggs["Price"].str.fullmatch("[0-9.]+")
eggs.loc[~is_num, "Price"] = None
eggs["Price"] = eggs["Price"].astype("float")

# Convert `Month` and `Year` column into a `Time` column.
dates = eggs["Month"] + eggs["Year"].astype(str)
dates = pd.to_datetime(dates, format = "%b%Y")
eggs["Time"] = dates
```

```{code-cell}
sns.lineplot(eggs, x = "Time", y = "Price")
```




### Planning


Matplotlib section:
* [x] Arranging multiple plots side-by-side (sort of---not if they create 2
  different plots with Seaborn)
* [x] Controlling plot size and margins
* [x] Setting titles
* [x] Setting/removing axis ticks, tick labels, and axis labels
    * Rotating axis labels
    * Inverting axes
* [x] Changing line types, point types, etc
* [x] Mathematical symbols in plot labels
* [x] Saving plots

* [ ] Themes (black/white, getting rid of chartjunk)
    * Color palettes

Case studies section:
* [x] Plotting curves
* [ ] Plotting an image
* [x] Plotting a time series
* [x] Annotating a plot
* [ ] Fixed aspect ratio
* [x] Labeling and positioning legends
* [x] Plotting with multiple datasets

Maybe:
* Putting error bars on a plot?
* Reordering presentation of levels

Low priority:
* Textured fills
* Changing coordinates (log, polar, …)
* Zoomed/inset plots
* Writing convenience functions (i.e., functions that produce customized plots)
--></section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="02_reproducible.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Making Python Projects &amp; Environments Reproducible</p>
      </div>
    </a>
    <a class="right-next"
       href="references.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">References</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites">5.1. Prerequisites</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thinking-in-matplotlib">5.2. Thinking in Matplotlib</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">5.2.1. Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#figures-axes">5.2.2. Figures &amp; Axes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coding-styles">5.2.3. Coding Styles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#drawing-on-axes">5.2.4. Drawing on Axes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#formatting-figures-axes">5.2.5. Formatting Figures &amp; Axes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-figures">5.2.6. Saving Figures</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualization-best-practices">5.3. Visualization Best Practices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#case-studies">5.4. Case Studies</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-a-categorical-distribution">5.4.1. Plotting a Categorical Distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-a-continuous-distribution">5.4.2. Plotting a Continuous Distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-a-time-series">5.4.3. Plotting a Time Series</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-a-function">5.4.4. Plotting a Function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-an-image">5.4.5. Plotting an Image</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-a-map">5.4.6. Plotting a Map</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Nick Ulle
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>